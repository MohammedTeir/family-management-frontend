import{t as S,r as m,w as P,j as e,C as u,e as h,f as p,d as j,B as g,x as F,I as R,a5 as f,a7 as B,a8 as L,a9 as b,U,aa as N,z as M}from"./index-BRVCUzIT.js";import{A as O,a as z}from"./alert-J9dsE8Mk.js";import{a as x}from"./dropdown-menu-DdnnckdS.js";import{P as H,U as $}from"./page-wrapper-D2Xzdxb4.js";import{F as v}from"./file-spreadsheet-Bd2LZWmb.js";import{C as w}from"./circle-check-big-DIzHHyic.js";import{C as q}from"./circle-x-Cp3bohXm.js";import{T as J}from"./triangle-alert-BLBGP7Kv.js";import"./index-uwi08Yf3.js";import"./file-text-Bxr2bFQ2.js";function se(){const{toast:n}=S(),[i,y]=m.useState(null),[r,o]=m.useState(null),[C,E]=m.useState("all"),d=P({mutationFn:async s=>{const t=new FormData;t.append("excel",s);const a=new AbortController,l=setTimeout(()=>a.abort(),10*60*1e3);try{const c=await M("POST","/api/admin/import-heads",t,{headers:{},signal:a.signal});return clearTimeout(l),c.data}catch(c){throw clearTimeout(l),c.name==="AbortError"?new Error("Import timeout - the file is too large or the process is taking too long"):c}},onSuccess:s=>{o(s),s.errorCount===0?n({title:"ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${s.successCount} Ø¹Ø§Ø¦Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­`}):s.successCount===0?n({title:"ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯",description:`ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙˆÙ (${s.errorCount} Ø®Ø·Ø£)`,variant:"destructive"}):n({title:"Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ø²Ø¦ÙŠ",description:s.message,variant:"default"})},onError:s=>{console.error("Import error:",s);let t=s.message;s.message.includes("404")?t="Ø§Ù„Ø®Ø¯Ù…Ø© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…":s.message.includes("403")?t="ØºÙŠØ± Ù…ØµØ±Ø­ Ù„Ùƒ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©":s.message.includes("500")?t="Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹":(s.message.includes("network")||s.message.includes("fetch"))&&(t="Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"),n({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯",description:t,variant:"destructive"})}}),I=s=>{var a;const t=(a=s.target.files)==null?void 0:a[0];if(t){if(!t.name.match(/\.(xlsx|xls)$/)){n({title:"Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel (.xlsx Ø£Ùˆ .xls)",variant:"destructive"});return}y(t),o(null)}},T=()=>{if(!i){n({title:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ù",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(i.size>10*1024*1024){n({title:"Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ±",description:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø£Ù‚Ù„ Ù…Ù† 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª",variant:"destructive"});return}o(null),d.mutate(i)},k=()=>{const s=[{husbandName:"Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ø¨Ùˆ Ø·ÙŠØ±",husbandID:"123456789",husbandBirthDate:"1980-01-15",husbandJob:"Ù…Ù‡Ù†Ø¯Ø³",primaryPhone:"0599123456",secondaryPhone:"0567789123",originalResidence:"ØºØ²Ø© - Ø§Ù„Ø´Ø¬Ø§Ø¹ÙŠØ©",currentHousing:"Ø±ÙØ­ - Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„",isDisplaced:"Ù†Ø¹Ù…",displacedLocation:"Ø±ÙØ­",isAbroad:"Ù„Ø§",warDamage2023:"Ù†Ø¹Ù…",warDamageDescription:"ØªØ¯Ù…ÙŠØ± ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ù†Ø²Ù„",branch:"ØºØ²Ø©",landmarkNear:"Ø¨Ø¬Ø§Ù†Ø¨ Ù…Ø³Ø¬Ø¯ Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡",totalMembers:"5",numMales:"3",numFemales:"2",socialStatus:"Ù…ØªØ²ÙˆØ¬",adminNotes:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©"}],t=Object.keys(s[0]).join(",")+`
`+s.map(A=>Object.values(A).join(",")).join(`
`),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),c=URL.createObjectURL(a);l.setAttribute("href",c),l.setAttribute("download","template-heads-import.csv"),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},D=s=>{const t={duplicateIds:[],otherErrors:[]};return s.forEach(a=>{a.includes("Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹")?t.duplicateIds.push(a):t.otherErrors.push(a)}),t};return e.jsx(H,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2 text-lg sm:text-xl",children:[e.jsx($,{className:"h-5 w-5 sm:h-6 sm:w-6"}),"Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø±Ø¤Ø³Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª Ù…Ù† Excel"]})}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs(O,{children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: Ø§Ø³Ù… Ø±Ø¨ Ø§Ù„Ø£Ø³Ø±Ø© (husbandName) ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© (husbandID)"}),e.jsx("li",{children:"Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 9 Ø£Ø±Ù‚Ø§Ù…"}),e.jsx("li",{children:"ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© ÙƒØ§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§ÙØªØ±Ø§Ø¶ÙŠØ©"}),e.jsx("li",{children:"Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©: ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ØŒ Ø§Ù„Ù…Ù‡Ù†Ø©ØŒ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‡ÙˆØ§ØªÙØŒ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³ÙƒÙ†ØŒ Ø¥Ù„Ø®"})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Excel"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Ù†Ù…ÙˆØ°Ø¬ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙˆØ§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©"})]}),e.jsxs(g,{variant:"outline",onClick:k,className:"w-full sm:w-auto",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{htmlFor:"excel-file",children:"Ø§Ø®ØªØ± Ù…Ù„Ù Excel"}),e.jsx(R,{id:"excel-file",type:"file",accept:".xlsx,.xls",onChange:I,className:"cursor-pointer"}),i&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(w,{className:"h-4 w-4"}),"ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù: ",i.name]})]}),e.jsx(g,{onClick:T,disabled:!i||d.isPending,className:"w-full",children:d.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 animate-spin"}),"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯..."]}):"Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"}),d.isPending&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx(f,{className:"h-8 w-8 animate-spin text-blue-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-blue-800 text-lg",children:"Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù..."}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù: ",e.jsx("span",{className:"font-medium",children:i==null?void 0:i.name})]}),e.jsxs("p",{className:"text-xs text-blue-600 mt-3 bg-blue-100 p-2 rounded",children:["â±ï¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ù‚Ø¯ ØªØ³ØªØºØ±Ù‚ Ù…Ù† 5-15 Ø¯Ù‚ÙŠÙ‚Ø© Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù",e.jsx("br",{}),"ðŸš« ÙŠØ±Ø¬Ù‰ Ø¹Ø¯Ù… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø© Ø£Ùˆ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©",e.jsx("br",{}),"âš¡ ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ¹Ø§Ø¦Ù„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…"]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-muted-foreground bg-muted p-3 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),e.jsx("span",{children:"Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¬Ø§Ø±ÙŠØ©... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±"}),e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse delay-150"})]})})]})]})]}),r&&e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[r.errorCount===0?e.jsx(w,{className:"h-5 w-5 text-green-600"}):e.jsx(q,{className:"h-5 w-5 text-red-600"}),"Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯"]})}),e.jsxs(j,{className:"space-y-4 p-4 sm:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 sm:p-6 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:r.successCount}),e.jsx("div",{className:"text-xs sm:text-sm text-green-800",children:"ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­"})]}),e.jsxs("div",{className:"text-center p-4 sm:p-6 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-600",children:r.errorCount}),e.jsx("div",{className:"text-xs sm:text-sm text-red-800",children:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯"})]})]}),r.errors&&r.errors.length>0&&(()=>{const s=D(r.errors),t=r.errors.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsxs("h4",{className:"font-semibold text-red-600 flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(J,{className:"h-4 w-4"}),"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (",t,")"]}),r.errorCount>20&&e.jsx(x,{variant:"outline",className:"text-xs self-start sm:self-auto",children:"Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 20 Ø®Ø·Ø£"})]}),e.jsxs(B,{value:C,onValueChange:E,children:[e.jsxs(L,{className:"flex w-full gap-1 mb-4 h-auto p-1 overflow-x-auto overflow-y-hidden",children:[e.jsxs(b,{value:"all",className:"text-xs sm:text-sm px-2 py-1 sm:px-3 sm:py-2 flex-shrink-0 whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡"}),e.jsx("span",{className:"sm:hidden",children:"Ø§Ù„ÙƒÙ„"}),e.jsx(x,{variant:"secondary",className:"ml-1 text-xs",children:t})]}),e.jsxs(b,{value:"duplicate",className:"text-xs sm:text-sm px-2 py-1 sm:px-3 sm:py-2 flex-shrink-0 whitespace-nowrap",disabled:s.duplicateIds.length===0,children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Ù‡ÙˆÙŠØ§Øª Ù…ÙƒØ±Ø±Ø©"}),e.jsx("span",{className:"sm:hidden",children:"Ù…ÙƒØ±Ø±"}),s.duplicateIds.length>0&&e.jsx(x,{variant:"destructive",className:"ml-1 text-xs",children:s.duplicateIds.length})]})]}),e.jsx(N,{value:"all",children:e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1",children:r.errors.map((a,l)=>e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded border-l-4 border-red-500",children:a},l))})}),e.jsx(N,{value:"duplicate",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"ðŸ‘¥ Ø£Ø±Ù‚Ø§Ù… Ù‡ÙˆÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…"}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1",children:s.duplicateIds.map((a,l)=>e.jsx("div",{className:"text-sm text-blue-600 bg-blue-50 p-2 rounded border-l-4 border-blue-500",children:a},l))})]})})]})]})})()]})]})]})})}export{se as default};
