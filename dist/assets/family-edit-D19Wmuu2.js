import{a as De,t as Ie,r as p,c as Se,w as E,j as e,B as j,a7 as je,a8 as Fe,a9 as oe,aa as xe,C as S,e as F,f as T,d as k,x as t,I as l,S as q,m as O,n as G,p as V,q as C,g as Te,k as ke,h as He,U as ge,y as re,N as Ne,M as ve,D as P,O as H,E as Ae,G as g,F as Be,v as Me,A as $e}from"./index-BRVCUzIT.js";import{S as w}from"./switch-CeNQc3pd.js";import{a as v}from"./dropdown-menu-DdnnckdS.js";import{P as he}from"./page-wrapper-D2Xzdxb4.js";import{A as _e}from"./arrow-left-GHDOehOI.js";import{P as ye}from"./plus-B3M91HrX.js";import{P as le,T as ie}from"./trash-2-a2eIXDOS.js";import"./index-uwi08Yf3.js";import"./file-text-Bxr2bFQ2.js";const ue=[{value:"abushalbia",label:"ابو شلبية (شلف - علاينة - عزايزة)"},{value:"alnaqra",label:"النقرة (الدوار)"},{value:"abuawda",label:"ابو عودة"},{value:"abunasr",label:"ابو نصر"},{value:"abumatar",label:"ابو مطر"}],Ee=[{value:"married",label:"متزوج"},{value:"polygamous",label:"متعدد زوجات"},{value:"widowed",label:"ارملة"},{value:"vulnerable_family",label:"اسر هشة (ايتام)"},{value:"abandoned",label:"متروكة"},{value:"divorced",label:"مطلقة"},{value:"single",label:"عانس"}],Pe=[{value:"total_destruction_uninhabitable",label:"هدم كلي غير قابل للسكن"},{value:"partial_destruction_habitable",label:"هدم جزئي قابل للسكن"},{value:"minor_damage",label:"أضرار بسيطة"}],me=[{value:"son",label:"ابن"},{value:"daughter",label:"ابنة"},{value:"mother",label:"أم"},{value:"father",label:"أب"},{value:"brother",label:"أخ"},{value:"sister",label:"أخت"},{value:"grandfather",label:"جد"},{value:"grandmother",label:"جدة"},{value:"uncle",label:"عم"},{value:"aunt",label:"عمة"},{value:"other",label:"أخرى"}];function We({params:i}){const b=i==null?void 0:i.id,[,X]=De(),{toast:f}=Ie(),[A,M]=p.useState("family"),[a,D]=p.useState(null),[I,y]=p.useState(!1),[L,R]=p.useState(""),[se,z]=p.useState(!1),[ae,B]=p.useState(!1),[$,m]=p.useState(""),[_,u]=p.useState(!1),[Y,Z]=p.useState(""),{data:d,isLoading:ne,refetch:n}=Se({queryKey:["/api/admin/families",b],queryFn:async()=>(await H.get(`/api/admin/families/${b}`)).data,enabled:!!b}),h=E({mutationFn:async s=>{const{wives:c,userGender:W,...o}=s;o.wifeName===""&&(o.wifeName=null),o.wifeID===""&&(o.wifeID=null),o.wifeBirthDate===""&&(o.wifeBirthDate=null),o.wifeJob===""&&(o.wifeJob=null),o.hasChronicIllness===void 0&&(o.hasChronicIllness=!1),o.hasChronicIllness===!1&&(o.chronicIllnessType=null),o.wifeHasChronicIllness===void 0&&(o.wifeHasChronicIllness=!1),o.wifeHasChronicIllness===!1&&(o.wifeChronicIllnessType=null),o.hasDisability===void 0&&(o.hasDisability=!1),o.hasDisability===!1&&(o.disabilityType=null),o.wifeHasDisability===void 0&&(o.wifeHasDisability=!1),o.wifeHasDisability===!1&&(o.wifeDisabilityType=null);const de=await H.put(`/api/admin/families/${b}`,o);if(W!==void 0&&(d!=null&&d.userId))try{await H.put(`/api/admin/users/${d.userId}`,{gender:W})}catch(ce){console.error("Error updating user gender:",ce)}return de.data},onSuccess:()=>{P.invalidateQueries({queryKey:["/api/admin/families",b]}),f({title:"تم التحديث بنجاح",description:"تم حفظ بيانات الأسرة"}),n()},onError:s=>{f({title:"خطأ في التحديث",description:s.message,variant:"destructive"})}}),ee=E({mutationFn:async s=>(s.relationship==="other"&&(s.relationship=L),s.isDisabled&&s.disabilityType==="custom"&&(s.disabilityType=$),(await H.post(`/api/admin/families/${b}/members`,s)).data),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/admin/families",b]}),f({title:"تمت إضافة الفرد",description:"تمت إضافة الفرد بنجاح"}),y(!1),D(null),n()},onError:s=>{f({title:"خطأ في الإضافة",description:s.message,variant:"destructive"})}}),te=E({mutationFn:async({memberId:s,data:c})=>(c.relationship==="other"&&(c.relationship=L),c.isDisabled&&c.disabilityType==="custom"&&(c.disabilityType=$),(await H.put(`/api/members/${s}`,c)).data),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/admin/families",b]}),f({title:"تم التحديث",description:"تم تحديث بيانات الفرد"}),y(!1),D(null),n()},onError:s=>{f({title:"خطأ في التحديث",description:s.message,variant:"destructive"})}}),J=E({mutationFn:async s=>(await H.delete(`/api/members/${s}`),s),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/admin/families",b]}),f({title:"تم الحذف",description:"تم حذف الفرد بنجاح"}),n()},onError:s=>{f({title:"خطأ في الحذف",description:s.message,variant:"destructive"})}}),[K,Q]=p.useState(null),[we,U]=p.useState(!1),fe=E({mutationFn:async s=>(await H.post("/api/orphans",{...s,familyId:b})).data,onSuccess:()=>{P.invalidateQueries({queryKey:["/api/admin/families",b]}),f({title:"تمت إضافة اليتيم",description:"تمت إضافة اليتيم بنجاح"}),U(!1),Q(null),n()},onError:s=>{f({title:"خطأ في الإضافة",description:s.message,variant:"destructive"})}}),pe=E({mutationFn:async({orphanId:s,data:c})=>(await H.put(`/api/orphans/${s}`,c)).data,onSuccess:()=>{P.invalidateQueries({queryKey:["/api/admin/families",b]}),f({title:"تم التحديث",description:"تم تحديث بيانات اليتيم"}),U(!1),Q(null),n()},onError:s=>{f({title:"خطأ في التحديث",description:s.message,variant:"destructive"})}}),be=E({mutationFn:async s=>(await H.delete(`/api/orphans/${s}`),s),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/admin/families",b]}),f({title:"تم الحذف",description:"تم حذف اليتيم بنجاح"}),n()},onError:s=>{f({title:"خطأ في الحذف",description:s.message,variant:"destructive"})}});p.useEffect(()=>{a?(z(!me.some(s=>s.value===a.relationship)),R(a.relationship&&!me.some(s=>s.value===a.relationship)?a.relationship:""),B(a.isDisabled),m(a.disabilityType||"")):(z(!1),R(""),B(!1),m(""))},[a]);const[r,N]=p.useState(null);p.useEffect(()=>{d&&N({...d,hasChronicIllness:d.hasChronicIllness||!1,wifeHasChronicIllness:d.wifeHasChronicIllness||!1,hasDisability:d.hasDisability||!1,wifeHasDisability:d.wifeHasDisability||!1})},[d]),p.useEffect(()=>{a&&(a.isDisabled?(m(a.disabilityType||""),B(!0)):(m(""),B(!1)),a.hasChronicIllness?(Z(a.chronicIllnessType||""),u(!0)):(Z(""),u(!1)))},[a]);function x(s){const{name:c,value:W,type:o,checked:de}=s.target;N(ce=>({...ce,[c]:o==="checkbox"?de:W}))}function Ce(s){s.preventDefault(),h.mutate({...r,branch:r.branch})}return ne||!r?e.jsx(he,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg text-muted-foreground",children:"جاري تحميل بيانات الأسرة..."})})}):d?e.jsx(he,{children:e.jsxs("div",{className:"space-y-6",dir:"rtl",children:[e.jsx("div",{className:"flex flex-row-reverse justify-end mb-4 w-full",children:e.jsxs(j,{variant:"ghost",onClick:()=>X("/admin/families"),className:"flex flex-row-reverse items-center",children:[e.jsx(_e,{className:"h-5 w-5 ml-2"})," عودة لقائمة الأسر"]})}),e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row-reverse md:items-center md:justify-between w-full gap-4",children:[e.jsx("div",{className:"flex flex-row-reverse items-center gap-4",children:e.jsxs("h1",{className:"text-lg md:text-2xl font-bold text-foreground ml-2 md:ml-4",children:["تعديل بيانات الأسرة ",e.jsxs(v,{className:"bg-blue-100 text-blue-800 text-xs md:text-sm",children:["#",d.id]})]})}),e.jsx(je,{value:A,onValueChange:M,className:"mb-0 w-full md:w-auto",children:e.jsxs(Fe,{className:"flex flex-row-reverse gap-1 md:gap-2 w-full md:w-auto",children:[e.jsx(oe,{value:"family",className:"text-xs md:text-sm flex-1 md:flex-none",children:"بيانات الأسرة"}),e.jsx(oe,{value:"members",className:"text-xs md:text-sm flex-1 md:flex-none",children:"أفراد الأسرة"}),e.jsx(oe,{value:"orphans",className:"text-xs md:text-sm flex-1 md:flex-none",children:"الأيتام"})]})})]}),e.jsxs(je,{value:A,onValueChange:M,className:"mb-8",children:[e.jsx(xe,{value:"family",children:e.jsxs(S,{className:"mb-8 border-blue-200 shadow-md",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-4",children:e.jsxs(T,{className:"flex items-center gap-2 text-blue-900",children:["تعديل بيانات الأسرة ",e.jsxs(v,{className:"bg-blue-200 text-blue-900",children:["#",d.id]})]})}),e.jsx(k,{children:e.jsxs("form",{id:"family-form",onSubmit:Ce,className:"space-y-6 md:space-y-8",children:[e.jsxs(S,{className:"border-indigo-200 shadow-sm",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(T,{className:"text-indigo-700 text-base md:text-lg",children:r.userGender==="female"?"بيانات ربة الأسرة":"بيانات رب الأسرة"})}),e.jsx(k,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"husbandName",className:"text-right w-full mb-1",children:"الاسم الرباعي *"}),e.jsx(l,{id:"husbandName",name:"husbandName",value:r.husbandName||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"husbandID",className:"text-right w-full mb-1",children:"رقم الهوية *"}),e.jsx(l,{id:"husbandID",name:"husbandID",value:r.husbandID||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"husbandBirthDate",className:"text-right w-full mb-1",children:"تاريخ الميلاد *"}),e.jsx(l,{id:"husbandBirthDate",name:"husbandBirthDate",type:"date",value:r.husbandBirthDate||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"husbandJob",className:"text-right w-full mb-1",children:"المهنة *"}),e.jsx(l,{id:"husbandJob",name:"husbandJob",value:r.husbandJob||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"headGender",className:"text-right w-full mb-1",children:"جنس رب/ربة الأسرة"}),e.jsxs(q,{dir:"rtl",value:r.userGender||(d==null?void 0:d.userGender)||"male",onValueChange:s=>N(c=>({...c,userGender:s})),children:[e.jsx(O,{className:"text-right w-full",dir:"rtl",children:e.jsx(G,{placeholder:"اختر الجنس"})}),e.jsxs(V,{dir:"rtl",children:[e.jsx(C,{value:"male",children:"ذكر (رب أسرة)"}),e.jsx(C,{value:"female",children:"أنثى (ربة أسرة)"})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"primaryPhone",className:"text-right w-full mb-1",children:"رقم الجوال الأساسي *"}),e.jsx(l,{id:"primaryPhone",name:"primaryPhone",value:r.primaryPhone||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"secondaryPhone",className:"text-right w-full mb-1",children:"رقم الجوال البديل"}),e.jsx(l,{id:"secondaryPhone",name:"secondaryPhone",value:r.secondaryPhone||"",onChange:x,className:"text-right mt-1"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasChronicIllness",name:"hasChronicIllness",checked:!!r.hasChronicIllness,onCheckedChange:s=>N(c=>({...c,hasChronicIllness:s}))}),e.jsx(t,{htmlFor:"hasChronicIllness",className:"cursor-pointer",children:"يعاني من مرض مزمن"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasDisability",name:"hasDisability",checked:!!r.hasDisability,onCheckedChange:s=>N(c=>({...c,hasDisability:s}))}),e.jsx(t,{htmlFor:"hasDisability",className:"cursor-pointer",children:"يعاني من إعاقة"})]})})]}),r.hasChronicIllness&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(t,{htmlFor:"chronicIllnessType",className:"text-right w-full mb-1",children:"نوع المرض المزمن"}),e.jsx(l,{id:"chronicIllnessType",name:"chronicIllnessType",value:r.chronicIllnessType||"",onChange:x,className:"text-right max-w-md w-full"})]}),r.hasDisability&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(t,{htmlFor:"disabilityType",className:"text-right w-full mb-1",children:"نوع الإعاقة"}),e.jsx(l,{id:"disabilityType",name:"disabilityType",value:r.disabilityType||"",onChange:x,className:"text-right max-w-md w-full"})]})]})]})})]}),e.jsxs(S,{className:"border-teal-200 shadow-sm",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(T,{className:"text-teal-700 text-base md:text-lg",children:r.userGender==="female"?"بيانات الزوج":"بيانات الزوجة"})}),e.jsx(k,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"wifeName",className:"text-right w-full mb-1",children:"الاسم الرباعي"}),e.jsx(l,{id:"wifeName",name:"wifeName",value:r.wifeName||"",onChange:x,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"wifeID",className:"text-right w-full mb-1",children:"رقم الهوية"}),e.jsx(l,{id:"wifeID",name:"wifeID",value:r.wifeID||"",onChange:x,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"wifeBirthDate",className:"text-right w-full mb-1",children:"تاريخ الميلاد"}),e.jsx(l,{id:"wifeBirthDate",name:"wifeBirthDate",type:"date",value:r.wifeBirthDate||"",onChange:x,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"wifeJob",className:"text-right w-full mb-1",children:"المهنة"}),e.jsx(l,{id:"wifeJob",name:"wifeJob",value:r.wifeJob||"",onChange:x,className:"text-right mt-1"})]}),r.userGender!=="female"?e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasChronicIllness",name:"wifeHasChronicIllness",checked:!!r.wifeHasChronicIllness,onCheckedChange:s=>N(c=>({...c,wifeHasChronicIllness:s}))}),e.jsx(t,{htmlFor:"wifeHasChronicIllness",className:"cursor-pointer",children:r.userGender==="female"?"يعاني من مرض مزمن":"تعاني من مرض مزمن"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasDisability",name:"wifeHasDisability",checked:!!r.wifeHasDisability,onCheckedChange:s=>N(c=>({...c,wifeHasDisability:s}))}),e.jsx(t,{htmlFor:"wifeHasDisability",className:"cursor-pointer",children:r.userGender==="female"?"يعاني من إعاقة":"تعاني من إعاقة"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifePregnant",name:"wifePregnant",checked:!!r.wifePregnant,onCheckedChange:s=>N(c=>({...c,wifePregnant:s}))}),e.jsx(t,{htmlFor:"wifePregnant",className:"cursor-pointer",children:"حامل"})]})})]}),r.wifeHasChronicIllness&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(t,{htmlFor:"wifeChronicIllnessType",className:"text-right w-full mb-1",children:"نوع المرض المزمن"}),e.jsx(l,{id:"wifeChronicIllnessType",name:"wifeChronicIllnessType",value:r.wifeChronicIllnessType||"",onChange:x,className:"text-right max-w-md w-full"})]}),r.wifeHasDisability&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(t,{htmlFor:"wifeDisabilityType",className:"text-right w-full mb-1",children:"نوع الإعاقة"}),e.jsx(l,{id:"wifeDisabilityType",name:"wifeDisabilityType",value:r.wifeDisabilityType||"",onChange:x,className:"text-right max-w-md w-full"})]})]}):e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasChronicIllness",name:"wifeHasChronicIllness",checked:!!r.wifeHasChronicIllness,onCheckedChange:s=>N(c=>({...c,wifeHasChronicIllness:s}))}),e.jsx(t,{htmlFor:"wifeHasChronicIllness",className:"cursor-pointer",children:r.userGender==="female"?"يعاني من مرض مزمن":"تعاني من مرض مزمن"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasDisability",name:"wifeHasDisability",checked:!!r.wifeHasDisability,onCheckedChange:s=>N(c=>({...c,wifeHasDisability:s}))}),e.jsx(t,{htmlFor:"wifeHasDisability",className:"cursor-pointer",children:r.userGender==="female"?"يعاني من إعاقة":"تعاني من إعاقة"})]})})]}),r.wifeHasChronicIllness&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(t,{htmlFor:"wifeChronicIllnessType",className:"text-right w-full mb-1",children:"نوع المرض المزمن"}),e.jsx(l,{id:"wifeChronicIllnessType",name:"wifeChronicIllnessType",value:r.wifeChronicIllnessType||"",onChange:x,className:"text-right max-w-md w-full"})]}),r.wifeHasDisability&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(t,{htmlFor:"wifeDisabilityType",className:"text-right w-full mb-1",children:"نوع الإعاقة"}),e.jsx(l,{id:"wifeDisabilityType",name:"wifeDisabilityType",value:r.wifeDisabilityType||"",onChange:x,className:"text-right max-w-md w-full"})]})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{className:"border-blue-200 shadow-sm",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(T,{className:"text-blue-700 text-base md:text-lg",children:"بيانات السكن"})}),e.jsx(k,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"originalResidence",className:"text-right w-full mb-1",children:"السكن الأصلي *"}),e.jsx(l,{id:"originalResidence",name:"originalResidence",value:r.originalResidence||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"currentHousing",className:"text-right w-full mb-1",children:"السكن الحالي *"}),e.jsx(l,{id:"currentHousing",name:"currentHousing",value:r.currentHousing||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"landmarkNear",className:"text-right w-full mb-1",children:"أقرب معلم"}),e.jsx(l,{id:"landmarkNear",name:"landmarkNear",value:r.landmarkNear||"",onChange:x,className:"text-right mt-1"})]})]})})]}),e.jsxs(S,{className:"border-purple-200 shadow-sm",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(T,{className:"text-purple-700 text-base md:text-lg",children:"المعلومات التنظيمية"})}),e.jsx(k,{className:"pt-3 pb-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-6",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"branch",className:"text-right w-full mb-1",children:"الفرع"}),e.jsxs(q,{value:ue.some(s=>s.value===r.branch)?r.branch:"",onValueChange:s=>x({target:{name:"branch",value:s}}),dir:"rtl",children:[e.jsx(O,{className:"text-right w-full max-w-md",children:e.jsx(G,{placeholder:"اختر الفرع"})}),e.jsx(V,{dir:"rtl",children:ue.map(s=>e.jsx(C,{value:s.value,children:Te(s.value)},s.value))})]}),ue.some(s=>s.value===r.branch)?null:e.jsx("div",{className:"mt-2 flex flex-col items-end",children:e.jsx(l,{className:"text-right max-w-md",placeholder:"قيمة فرع غير صحيحة",value:r.branch,disabled:!0})})]})})})]}),e.jsxs(S,{className:"border-orange-200 shadow-sm",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(T,{className:"text-orange-700 text-base md:text-lg",children:"المعلومات الشخصية والاجتماعية"})}),e.jsx(k,{className:"pt-3 pb-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-6",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"socialStatus",className:"text-right w-full mb-1",children:"الحالة الاجتماعية"}),e.jsxs(q,{value:r.socialStatus||"",onValueChange:s=>x({target:{name:"socialStatus",value:s}}),dir:"rtl",children:[e.jsx(O,{className:"text-right w-full max-w-md",children:e.jsx(G,{placeholder:"اختر الحالة"})}),e.jsx(V,{dir:"rtl",children:Ee.map(s=>e.jsx(C,{value:s.value,children:ke(s.value)},s.value))})]})]})})})]}),e.jsxs(S,{className:"border-red-200 shadow-sm",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(T,{className:"text-red-700 text-base md:text-lg",children:"المعلومات الاجتماعية والمعيشية"})}),e.jsx(k,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"warDamageDescription",className:"text-right w-full mb-1",children:"وصف الضرر"}),e.jsxs(q,{value:r.warDamageDescription||"",onValueChange:s=>x({target:{name:"warDamageDescription",value:s}}),dir:"rtl",className:"w-full max-w-md",children:[e.jsx(O,{className:"text-right",children:e.jsx(G,{placeholder:"اختر وصف الضرر"})}),e.jsx(V,{dir:"rtl",children:Pe.map(s=>e.jsx(C,{value:s.value,children:He(s.value)},s.value))})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"isDisplaced",name:"isDisplaced",checked:!!r.isDisplaced,onCheckedChange:s=>N(c=>({...c,isDisplaced:s}))}),e.jsx(t,{htmlFor:"isDisplaced",className:"cursor-pointer",children:"نازح؟"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"isAbroad",name:"isAbroad",checked:!!r.isAbroad,onCheckedChange:s=>N(c=>({...c,isAbroad:s}))}),e.jsx(t,{htmlFor:"isAbroad",className:"cursor-pointer",children:"مغترب؟"})]})})]}),r.isDisplaced&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(t,{htmlFor:"displacedLocation",className:"text-right w-full mb-1",children:"مكان النزوح"}),e.jsx(l,{id:"displacedLocation",name:"displacedLocation",value:r.displacedLocation||"",onChange:x,className:"text-right max-w-md w-full"})]})]})})]}),e.jsxs(S,{className:"border-green-200 shadow-sm",children:[e.jsx(F,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(T,{className:"text-green-700 text-base md:text-lg",children:"أفراد الأسرة"})}),e.jsx(k,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"totalMembers",className:"text-right w-full mb-1",children:"عدد الأفراد *"}),e.jsx(l,{id:"totalMembers",name:"totalMembers",value:r.totalMembers||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"numMales",className:"text-right w-full mb-1",children:"عدد الذكور *"}),e.jsx(l,{id:"numMales",name:"numMales",value:r.numMales||"",onChange:x,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(t,{htmlFor:"numFemales",className:"text-right w-full mb-1",children:"عدد الإناث *"}),e.jsx(l,{id:"numFemales",name:"numFemales",value:r.numFemales||"",onChange:x,required:!0,className:"text-right mt-1"})]})]})})]})]}),e.jsx("div",{className:"flex justify-end mt-6 md:mt-8",children:e.jsx(j,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",disabled:h.isPending,children:h.isPending?"جاري الحفظ...":"حفظ التعديلات"})})]})})]})}),e.jsx(xe,{value:"members",children:e.jsxs(S,{className:"border-green-200 shadow-md",children:[e.jsxs(F,{className:"flex flex-col sm:flex-row-reverse sm:items-center sm:justify-between gap-4",children:[e.jsxs(T,{className:"flex items-center gap-2 text-green-900 text-base md:text-lg",children:[e.jsx(ge,{className:"h-5 w-5 ml-1 text-green-600"})," أفراد الأسرة"]}),e.jsxs(j,{onClick:()=>{D(null),y(!0)},className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto text-sm",children:[e.jsx(ye,{className:"h-4 w-4 ml-2"})," إضافة فرد"]})]}),e.jsxs(k,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-background",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"الإجراءات"}),e.jsx("th",{className:"px-3 py-2",children:"العمر"}),e.jsx("th",{className:"px-3 py-2",children:"تاريخ الميلاد"}),e.jsx("th",{className:"px-3 py-2",children:"القرابة"}),e.jsx("th",{className:"px-3 py-2",children:"الجنس"}),e.jsx("th",{className:"px-3 py-2",children:"الاسم"}),e.jsx("th",{className:"px-3 py-2",children:"الهوية"})]})}),e.jsx("tbody",{children:d.members&&d.members.length>0?d.members.map(s=>e.jsxs("tr",{className:"border-b hover:bg-background",children:[e.jsxs("td",{className:"px-3 py-2 flex gap-2 justify-end",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{D(s),y(!0)},children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(j,{size:"sm",variant:"destructive",onClick:()=>J.mutate(s.id),children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsx("td",{className:"px-3 py-2",children:s.birthDate?e.jsx(v,{className:"bg-green-100 text-green-800",children:re(s.birthDate)}):"-"}),e.jsx("td",{className:"px-3 py-2",children:s.birthDate||"غير محدد"}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(v,{className:"bg-muted text-foreground",children:Ne(s.relationship)})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(v,{className:s.gender==="male"?"bg-blue-100 text-blue-800":"bg-pink-100 text-pink-800",children:ve(s.gender)})}),e.jsx("td",{className:"px-3 py-2 font-medium",children:s.fullName}),e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:s.memberID||"غير محدد"})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-muted-foreground py-4",children:"لا يوجد أفراد مسجلين لهذه الأسرة."})})})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:d.members&&d.members.length>0?d.members.map(s=>e.jsx("div",{className:"bg-muted/30 rounded-lg p-4 space-y-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:s.memberID||"غير محدد"}),e.jsx("h4",{className:"font-medium text-sm",children:s.fullName})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(v,{className:s.gender==="male"?"bg-blue-100 text-blue-800 text-xs":"bg-pink-100 text-pink-800 text-xs",children:ve(s.gender)}),e.jsx(v,{className:"bg-muted text-foreground text-xs",children:Ne(s.relationship)}),s.birthDate&&e.jsx(v,{className:"bg-green-100 text-green-800 text-xs",children:re(s.birthDate)})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["رقم الهوية: ",s.memberID||"غير محدد"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["تاريخ الميلاد: ",s.birthDate||"غير محدد"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{D(s),y(!0)},className:"p-2",children:e.jsx(le,{className:"h-3 w-3"})}),e.jsx(j,{size:"sm",variant:"destructive",onClick:()=>J.mutate(s.id),className:"p-2",children:e.jsx(ie,{className:"h-3 w-3"})})]})]})},s.id)):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"لا يوجد أفراد مسجلين لهذه الأسرة."})}),I&&e.jsx(qe,{initialData:a,onSubmit:a?s=>te.mutate({memberId:a.id,data:s}):ee.mutate,isLoading:ee.isPending||te.isPending,isEdit:!!a,onCancel:()=>{y(!1),D(null)},customRelationship:L,setCustomRelationship:R,showCustomRelationship:se,setShowCustomRelationship:z,showDisabilityType:ae,setShowDisabilityType:B,customDisabilityType:$,setCustomDisabilityType:m,showChronicIllnessType:_,setShowChronicIllnessType:u,customChronicIllnessType:Y,setCustomChronicIllnessType:Z})]})]})}),e.jsx(xe,{value:"orphans",children:e.jsxs(S,{className:"border-purple-200 shadow-md",children:[e.jsxs(F,{className:"flex flex-col sm:flex-row-reverse sm:items-center sm:justify-between gap-4",children:[e.jsxs(T,{className:"flex items-center gap-2 text-purple-900 text-base md:text-lg",children:[e.jsx(ge,{className:"h-5 w-5 ml-1 text-purple-600"})," الأيتام"]}),e.jsxs(j,{onClick:()=>{Q(null),U(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white w-full sm:w-auto text-sm",children:[e.jsx(ye,{className:"h-4 w-4 ml-2"})," إضافة يتيم"]})]}),e.jsxs(k,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-background",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"الإجراءات"}),e.jsx("th",{className:"px-3 py-2",children:"العمر"}),e.jsx("th",{className:"px-3 py-2",children:"تاريخ الميلاد"}),e.jsx("th",{className:"px-3 py-2",children:"حالة الوفاة"}),e.jsx("th",{className:"px-3 py-2",children:"اسم الوصي"}),e.jsx("th",{className:"px-3 py-2",children:"الاسم"}),e.jsx("th",{className:"px-3 py-2",children:"الهوية"})]})}),e.jsx("tbody",{children:d.orphans&&d.orphans.length>0?d.orphans.map(s=>e.jsxs("tr",{className:"border-b hover:bg-background",children:[e.jsxs("td",{className:"px-3 py-2 flex gap-2 justify-end",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{Q(s),U(!0)},children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(j,{size:"sm",variant:"destructive",onClick:()=>be.mutate(s.id),children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsx("td",{className:"px-3 py-2",children:s.orphanBirthDate?e.jsx(v,{className:"bg-purple-100 text-purple-800",children:re(s.orphanBirthDate)}):"-"}),e.jsx("td",{className:"px-3 py-2",children:s.orphanBirthDate||"غير محدد"}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs(v,{className:"bg-muted text-foreground",children:[s.martyrdomType==="war_2023"&&"شهيد حرب ٢٠٢٣",s.martyrdomType==="pre_2023_war"&&"شهيد حرب ما قبل ذلك",s.martyrdomType==="natural_death"&&"وفاة طبيعية",!s.martyrdomType&&"غير محدد"]})}),e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:s.guardianName}),e.jsx("td",{className:"px-3 py-2 font-medium",children:s.orphanName}),e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:s.orphanID||"غير محدد"})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-muted-foreground py-4",children:"لا يوجد أيتام مسجلين لهذه الأسرة."})})})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:d.orphans&&d.orphans.length>0?d.orphans.map(s=>e.jsx("div",{className:"bg-muted/30 rounded-lg p-4 space-y-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:s.orphanID||"غير محدد"}),e.jsx("h4",{className:"font-medium text-sm",children:s.orphanName})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.orphanBirthDate&&e.jsx(v,{className:"bg-purple-100 text-purple-800 text-xs",children:re(s.orphanBirthDate)}),e.jsxs(v,{className:"bg-muted text-foreground text-xs",children:[s.martyrdomType==="war_2023"&&"شهيد حرب ٢٠٢٣",s.martyrdomType==="pre_2023_war"&&"شهيد حرب ما قبل ذلك",s.martyrdomType==="natural_death"&&"وفاة طبيعية",!s.martyrdomType&&"غير محدد"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["رقم الهوية: ",s.orphanID||"غير محدد"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["تاريخ الميلاد: ",s.orphanBirthDate||"غير محدد"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["اسم الوصي: ",s.guardianName]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{Q(s),U(!0)},className:"p-2",children:e.jsx(le,{className:"h-3 w-3"})}),e.jsx(j,{size:"sm",variant:"destructive",onClick:()=>be.mutate(s.id),className:"p-2",children:e.jsx(ie,{className:"h-3 w-3"})})]})]})},s.id)):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"لا يوجد أيتام مسجلين لهذه الأسرة."})}),we&&e.jsx(Oe,{initialData:K,onSubmit:K?s=>pe.mutate({orphanId:K.id,data:s}):s=>fe.mutate(s),isLoading:fe.isPending||pe.isPending,isEdit:!!K,onCancel:()=>{U(!1),Q(null)}})]})]})})]})]})}):e.jsx(he,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg text-muted-foreground",children:"لا توجد بيانات متاحة لهذه الأسرة."})})})}function qe({initialData:i,onSubmit:b,onCancel:X,isLoading:f,isEdit:A,customRelationship:M,setCustomRelationship:a,showCustomRelationship:D,setShowCustomRelationship:I,showDisabilityType:y,setShowDisabilityType:L,customDisabilityType:R,setCustomDisabilityType:se,showChronicIllnessType:z,setShowChronicIllnessType:ae,customChronicIllnessType:B,setCustomChronicIllnessType:$}){const[m,_]=p.useState({fullName:(i==null?void 0:i.fullName)||"",memberID:(i==null?void 0:i.memberID)||"",birthDate:(i==null?void 0:i.birthDate)||"",gender:(i==null?void 0:i.gender)||"male",relationship:me.some(n=>n.value===(i==null?void 0:i.relationship))?i==null?void 0:i.relationship:i!=null&&i.relationship?"other":"son",isDisabled:(i==null?void 0:i.isDisabled)||!1,disabilityType:(i==null?void 0:i.disabilityType)||"",hasChronicIllness:(i==null?void 0:i.hasChronicIllness)||!1,chronicIllnessType:(i==null?void 0:i.chronicIllnessType)||""}),[u,Y]=p.useState({fullName:"",memberID:"",birthDate:"",gender:"",relationship:""});p.useEffect(()=>{I(m.relationship==="other")},[m.relationship,I]),p.useEffect(()=>{L(m.isDisabled)},[m.isDisabled,L]),p.useEffect(()=>{ae(m.hasChronicIllness),m.hasChronicIllness&&m.chronicIllnessType&&$(m.chronicIllnessType)},[m.hasChronicIllness,m.chronicIllnessType,ae]);const Z=()=>{const n={fullName:!m.fullName||m.fullName.trim()===""?"الاسم مطلوب":"",memberID:m.memberID&&m.memberID.length>0&&m.memberID.length!==9?"رقم الهوية يجب أن يكون 9 أرقام":"",birthDate:m.birthDate?"":"تاريخ الميلاد مطلوب",gender:m.gender?"":"الجنس مطلوب",relationship:m.relationship?"":"القرابة مطلوبة"};return Y(n),!Object.values(n).some(h=>h!=="")};function d(n){const{name:h,value:ee,type:te,checked:J}=n.target;_(K=>({...K,[h]:te==="checkbox"?J:ee})),h==="relationship"&&ee==="other"&&a(""),h==="isDisabled"&&!J&&se(""),h==="hasChronicIllness"&&!J&&$("")}function ne(n){n.preventDefault(),Z()&&b({...m,relationship:m.relationship==="other"?M:m.relationship,disabilityType:y?R:"",chronicIllnessType:z?B:""})}return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",dir:"rtl",children:e.jsxs("form",{onSubmit:ne,className:"space-y-4 md:space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:A?"تعديل بيانات الفرد":"إضافة فرد جديد"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"fullName",className:"text-sm sm:text-base font-medium",children:"الاسم الكامل *"}),e.jsx(l,{id:"fullName",name:"fullName",value:m.fullName,onChange:d,className:`text-right mt-1 ${u.fullName?"border-destructive focus:ring-destructive":""}`}),u.fullName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:u.fullName})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"memberID",className:"text-sm sm:text-base font-medium",children:"رقم الهوية"}),e.jsx(l,{id:"memberID",name:"memberID",value:m.memberID,onChange:d,className:`text-right mt-1 ${u.memberID?"border-destructive focus:ring-destructive":""}`}),u.memberID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:u.memberID})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"birthDate",className:"text-sm sm:text-base font-medium",children:"تاريخ الميلاد *"}),e.jsx(l,{id:"birthDate",name:"birthDate",type:"date",value:m.birthDate,onChange:d,className:`text-right mt-1 ${u.birthDate?"border-destructive focus:ring-destructive":""}`}),u.birthDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:u.birthDate})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"gender",className:"text-sm sm:text-base font-medium",children:"الجنس *"}),e.jsxs(q,{value:m.gender,onValueChange:n=>{_(h=>({...h,gender:n})),u.gender&&Y(h=>({...h,gender:""}))},dir:"rtl",children:[e.jsx(O,{className:`text-right ${u.gender?"border-destructive focus:ring-destructive":""}`,children:e.jsx(G,{placeholder:"اختر الجنس",className:"text-right"})}),e.jsxs(V,{dir:"rtl",children:[e.jsx(C,{value:"male",className:"text-right",children:"ذكر"}),e.jsx(C,{value:"female",className:"text-right",children:"أنثى"})]})]}),u.gender&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:u.gender})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"relationship",className:"text-sm sm:text-base font-medium",children:"القرابة *"}),e.jsxs(q,{value:m.relationship,onValueChange:n=>{_(h=>({...h,relationship:n})),u.relationship&&Y(h=>({...h,relationship:""}))},dir:"rtl",children:[e.jsx(O,{className:`text-right ${u.relationship?"border-destructive focus:ring-destructive":""}`,children:e.jsx(G,{placeholder:"اختر القرابة",className:"text-right"})}),e.jsx(V,{dir:"rtl",children:me.map(n=>e.jsx(C,{value:n.value,className:"text-right",children:n.label},n.value))})]}),D&&e.jsx(l,{className:"mt-2 text-right",placeholder:"أدخل القرابة",value:M,onChange:n=>a(n.target.value)}),u.relationship&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:u.relationship})]}),e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"isDisabled",name:"isDisabled",checked:m.isDisabled,onCheckedChange:n=>_(h=>({...h,isDisabled:n}))}),e.jsx(t,{htmlFor:"isDisabled",className:"cursor-pointer",children:"يعاني من إعاقة"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasChronicIllness",name:"hasChronicIllness",checked:m.hasChronicIllness,onCheckedChange:n=>_(h=>({...h,hasChronicIllness:n}))}),e.jsx(t,{htmlFor:"hasChronicIllness",className:"cursor-pointer",children:"يعاني من مرض مزمن"})]})})]}),y&&e.jsxs("div",{children:[e.jsx(t,{htmlFor:"disabilityType",className:"text-sm sm:text-base font-medium",children:"نوع الإعاقة"}),e.jsx(l,{id:"disabilityType",name:"disabilityType",value:R,onChange:n=>se(n.target.value),className:"text-right mt-1"})]}),z&&e.jsxs("div",{children:[e.jsx(t,{htmlFor:"chronicIllnessType",className:"text-sm sm:text-base font-medium",children:"نوع المرض المزمن"}),e.jsx(l,{id:"chronicIllnessType",name:"chronicIllnessType",value:B,onChange:n=>$(n.target.value),className:"text-right mt-1"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 pt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:X,className:"w-full sm:w-auto",children:"إلغاء"}),e.jsx(j,{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto",disabled:f,children:f?"جاري الحفظ...":A?"تحديث":"إضافة"})]})]})})})}function Oe({initialData:i,onSubmit:b,onCancel:X,isLoading:f,isEdit:A}){const M=Ae({orphanName:g().min(1,"اسم اليتيم مطلوب"),orphanBirthDate:g().min(1,"تاريخ ميلاد اليتيم مطلوب"),orphanID:g().regex(/^\d{9}$/,"رقم هوية اليتيم يجب أن يكون 9 أرقام").optional(),guardianName:g().min(1,"اسم الوصي مطلوب"),guardianID:g().regex(/^\d{9}$/,"رقم هوية الوصي يجب أن يكون 9 أرقام"),guardianBirthDate:g().min(1,"تاريخ ميلاد الوصي مطلوب"),fatherName:g().min(1,"اسم الاب مطلوب"),fatherID:g().regex(/^\d{9}$/,"رقم هوية الاب يجب أن يكون 9 أرقام"),martyrdomDate:g().min(1,"تاريخ الاستشهاد مطلوب"),martyrdomType:Be(["war_2023","pre_2023_war","natural_death"],{errorMap:(I,y)=>I.code==="invalid_enum_value"?{message:"حالة الوفاة مطلوبة"}:{message:y.defaultError}}),bankAccountNumber:g().min(1,"رقم حساب البنك مطلوب"),accountHolderName:g().min(1,"اسم صاحب الحساب مطلوب"),currentAddress:g().min(1,"العنوان الحالي مطلوب"),originalAddress:g().min(1,"العنوان الاصلي مطلوب"),mobileNumber:g().regex(/^\d{10}$/,"رقم الجوال يجب أن يكون 10 أرقام"),backupMobileNumber:g().regex(/^\d{10}$/,"رقم الجوال الاحتياطي يجب أن يكون 10 أرقام").optional()}),a=Me({resolver:$e(M),defaultValues:{orphanName:"",orphanBirthDate:"",orphanID:"",guardianName:"",guardianID:"",guardianBirthDate:"",fatherName:"",fatherID:"",martyrdomDate:"",martyrdomType:"",bankAccountNumber:"",accountHolderName:"",currentAddress:"",originalAddress:"",mobileNumber:"",backupMobileNumber:"",...i}}),D=I=>{b(I)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-6 w-full max-w-xl max-h-[90vh] overflow-y-auto",dir:"rtl",children:e.jsxs("form",{onSubmit:a.handleSubmit(D),className:"space-y-4 md:space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:A?"تعديل بيانات اليتيم":"إضافة يتيم جديد"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"orphanName",className:"text-sm sm:text-base font-medium",children:"اسم اليتيم *"}),e.jsx(l,{id:"orphanName",placeholder:"اسم اليتيم",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.orphanName?"border-destructive focus:ring-destructive":""}`,...a.register("orphanName")}),a.formState.errors.orphanName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.orphanName.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"orphanID",className:"text-sm sm:text-base font-medium",children:"رقم هوية اليتيم"}),e.jsx(l,{id:"orphanID",placeholder:"رقم هوية اليتيم",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.orphanID?"border-destructive focus:ring-destructive":""}`,...a.register("orphanID")}),a.formState.errors.orphanID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.orphanID.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"orphanBirthDate",className:"text-sm sm:text-base font-medium",children:"تاريخ ميلاد اليتيم *"}),e.jsx(l,{id:"orphanBirthDate",type:"date",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.orphanBirthDate?"border-destructive focus:ring-destructive":""}`,...a.register("orphanBirthDate")}),a.formState.errors.orphanBirthDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.orphanBirthDate.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"guardianName",className:"text-sm sm:text-base font-medium",children:"اسم الوصي *"}),e.jsx(l,{id:"guardianName",placeholder:"اسم الوصي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.guardianName?"border-destructive focus:ring-destructive":""}`,...a.register("guardianName")}),a.formState.errors.guardianName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.guardianName.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"guardianID",className:"text-sm sm:text-base font-medium",children:"رقم هوية الوصي *"}),e.jsx(l,{id:"guardianID",placeholder:"رقم هوية الوصي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.guardianID?"border-destructive focus:ring-destructive":""}`,...a.register("guardianID")}),a.formState.errors.guardianID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.guardianID.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"guardianBirthDate",className:"text-sm sm:text-base font-medium",children:"تاريخ ميلاد الوصي *"}),e.jsx(l,{id:"guardianBirthDate",type:"date",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.guardianBirthDate?"border-destructive focus:ring-destructive":""}`,...a.register("guardianBirthDate")}),a.formState.errors.guardianBirthDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.guardianBirthDate.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"fatherName",className:"text-sm sm:text-base font-medium",children:"اسم الاب *"}),e.jsx(l,{id:"fatherName",placeholder:"اسم الاب",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.fatherName?"border-destructive focus:ring-destructive":""}`,...a.register("fatherName")}),a.formState.errors.fatherName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.fatherName.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"fatherID",className:"text-sm sm:text-base font-medium",children:"رقم هوية الاب *"}),e.jsx(l,{id:"fatherID",placeholder:"رقم هوية الاب",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.fatherID?"border-destructive focus:ring-destructive":""}`,...a.register("fatherID")}),a.formState.errors.fatherID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.fatherID.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"martyrdomDate",className:"text-sm sm:text-base font-medium",children:"تاريخ الاستشهاد *"}),e.jsx(l,{id:"martyrdomDate",type:"date",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.martyrdomDate?"border-destructive focus:ring-destructive":""}`,...a.register("martyrdomDate")}),a.formState.errors.martyrdomDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.martyrdomDate.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"martyrdomType",className:"text-sm sm:text-base font-medium",children:"حالة الوفاة *"}),e.jsxs(q,{value:["war_2023","pre_2023_war","natural_death"].includes(a.watch("martyrdomType")||"")?a.watch("martyrdomType"):"",onValueChange:I=>a.setValue("martyrdomType",I),children:[e.jsx(O,{className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.martyrdomType?"border-destructive focus:ring-destructive":""}`,children:e.jsx(G,{placeholder:"اختر حالة الوفاة"})}),e.jsxs(V,{children:[e.jsx(C,{value:"war_2023",className:"text-sm sm:text-base",children:"شهيد حرب ٢٠٢٣"}),e.jsx(C,{value:"pre_2023_war",className:"text-sm sm:text-base",children:"شهيد حرب ما قبل ذلك"}),e.jsx(C,{value:"natural_death",className:"text-sm sm:text-base",children:"وفاة طبيعية"})]})]}),a.formState.errors.martyrdomType&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.martyrdomType.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"bankAccountNumber",className:"text-sm sm:text-base font-medium",children:"رقم حساب البنك *"}),e.jsx(l,{id:"bankAccountNumber",placeholder:"رقم حساب البنك",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.bankAccountNumber?"border-destructive focus:ring-destructive":""}`,...a.register("bankAccountNumber")}),a.formState.errors.bankAccountNumber&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.bankAccountNumber.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"accountHolderName",className:"text-sm sm:text-base font-medium",children:"اسم صاحب الحساب *"}),e.jsx(l,{id:"accountHolderName",placeholder:"اسم صاحب الحساب",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.accountHolderName?"border-destructive focus:ring-destructive":""}`,...a.register("accountHolderName")}),a.formState.errors.accountHolderName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.accountHolderName.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"mobileNumber",className:"text-sm sm:text-base font-medium",children:"رقم الجوال *"}),e.jsx(l,{id:"mobileNumber",placeholder:"رقم الجوال",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.mobileNumber?"border-destructive focus:ring-destructive":""}`,...a.register("mobileNumber")}),a.formState.errors.mobileNumber&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.mobileNumber.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"backupMobileNumber",className:"text-sm sm:text-base font-medium",children:"رقم جوال احتياطي"}),e.jsx(l,{id:"backupMobileNumber",placeholder:"رقم جوال احتياطي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.backupMobileNumber?"border-destructive focus:ring-destructive":""}`,...a.register("backupMobileNumber")}),a.formState.errors.backupMobileNumber&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.backupMobileNumber.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(t,{htmlFor:"currentAddress",className:"text-sm sm:text-base font-medium",children:"العنوان الحالي *"}),e.jsx(l,{id:"currentAddress",placeholder:"العنوان الحالي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.currentAddress?"border-destructive focus:ring-destructive":""}`,...a.register("currentAddress")}),a.formState.errors.currentAddress&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.currentAddress.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(t,{htmlFor:"originalAddress",className:"text-sm sm:text-base font-medium",children:"العنوان الاصلي *"}),e.jsx(l,{id:"originalAddress",placeholder:"العنوان الاصلي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${a.formState.errors.originalAddress?"border-destructive focus:ring-destructive":""}`,...a.register("originalAddress")}),a.formState.errors.originalAddress&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.originalAddress.message})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 pt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:X,className:"w-full sm:w-auto",children:"إلغاء"}),e.jsx(j,{type:"submit",disabled:f,className:"bg-purple-600 hover:bg-purple-700 text-white w-full sm:w-auto",children:f?"جاري الحفظ...":A?"تحديث":"إضافة"})]})]})})})}export{We as default};
