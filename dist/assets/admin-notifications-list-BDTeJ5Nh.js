import{u as j,c as i,b as f,r as N,j as e,C as b,e as y,f as v,d as w}from"./index-ZYzdAsGm.js";import{B as C,a as r}from"./dropdown-menu-C5FzIU9D.js";import{P as S}from"./page-wrapper-DEQQYva8.js";import"./index-CvI2JamZ.js";import"./baby-B20HtjzY.js";import"./file-text-WTwHpCUH.js";function q(){const{user:u}=j(),{data:h,isLoading:p}=i({queryKey:["/api/notifications"]}),{data:a}=i({queryKey:["/api/admin/families"]}),{data:l}=i({queryKey:["/api/admin/users"]}),{settings:s}=f();N.useEffect(()=>{s.siteTitle&&(document.title=s.siteTitle),s.language&&(document.documentElement.lang=s.language,document.body.dir=s.language==="ar"?"rtl":"ltr")},[s.siteTitle,s.language]);const d=(h||[]).filter(t=>t.target==="all"||t.target==="urgent"||t.target==="admin"||t.target==="specific"&&Array.isArray(t.recipients)&&u&&t.recipients.includes(u.id)),g=t=>{switch(t){case"all":return"جميع المستخدمين";case"head":return"رؤساء الأسر";case"urgent":return"تنبيه عاجل";case"specific":return"مستخدمين محددين";default:return t}},o=t=>t.target==="urgent"?e.jsx(r,{className:"bg-red-600 text-white",children:"عاجل"}):t.target==="success"?e.jsx(r,{className:"bg-green-600 text-white",children:"نجاح"}):t.target==="head"?e.jsx(r,{className:"bg-purple-600 text-white",children:"رؤساء الأسر"}):t.target==="admin"?e.jsx(r,{className:"bg-orange-500 text-white",children:"مشرفين"}):t.target==="all"?e.jsx(r,{className:"bg-blue-600 text-white",children:"الكل"}):t.target==="specific"?e.jsx(r,{className:"bg-teal-600 text-white",children:"محدد"}):e.jsx(r,{variant:"default",children:"معلومات"});return e.jsx(S,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-foreground mb-2",children:"التنبيهات التي استلمتها"}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"عرض جميع التنبيهات المستلمة"})]})}),e.jsxs(b,{children:[e.jsx(y,{children:e.jsxs(v,{children:["قائمة التنبيهات (",d.length,")"]})}),e.jsx(w,{children:p?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"جاري تحميل التنبيهات..."}):d&&d.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-2 md:px-4 text-left text-xs md:text-sm font-semibold text-muted-foreground",children:"العنوان"}),e.jsx("th",{className:"py-2 px-2 md:px-4 text-left text-xs md:text-sm font-semibold text-muted-foreground hidden md:table-cell",children:"الرسالة"}),e.jsx("th",{className:"py-2 px-2 md:px-4 text-left text-xs md:text-sm font-semibold text-muted-foreground",children:"الهدف"}),e.jsx("th",{className:"py-2 px-2 md:px-4 text-left text-xs md:text-sm font-semibold text-muted-foreground hidden lg:table-cell",children:"المستقبلين"}),e.jsx("th",{className:"py-2 px-2 md:px-4 text-left text-xs md:text-sm font-semibold text-muted-foreground hidden sm:table-cell",children:"تاريخ الإرسال"}),e.jsx("th",{className:"py-2 px-2 md:px-4 text-left text-xs md:text-sm font-semibold text-muted-foreground hidden xl:table-cell",children:"من"})]})}),e.jsx("tbody",{className:"bg-card divide-y divide-border",children:d.map(t=>e.jsxs("tr",{className:"hover:bg-muted",children:[e.jsx("td",{className:"py-2 px-2 md:px-4 text-xs md:text-sm text-foreground",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:t.title}),e.jsx("span",{className:"md:hidden text-xs text-muted-foreground mt-1 truncate max-w-40",children:t.message}),e.jsx("span",{className:"sm:hidden text-xs text-muted-foreground mt-1",children:new Date(t.createdAt).toLocaleString("ar-EG",{dateStyle:"short",timeStyle:"short"})})]})}),e.jsx("td",{className:"py-2 px-2 md:px-4 text-xs md:text-sm text-foreground hidden md:table-cell",children:e.jsx("span",{className:"max-w-xs truncate block",children:t.message})}),e.jsx("td",{className:"py-2 px-2 md:px-4 text-xs md:text-sm text-foreground",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs hidden sm:inline",children:g(t.target)}),o(t),e.jsx("span",{className:"lg:hidden text-xs text-muted-foreground mt-1",children:t.target==="admin"&&(!t.recipients||t.recipients.length===0)?"جميع المشرفين":t.recipients&&t.recipients.length>0?`${t.recipients.length} مستخدم`:"جميع المستخدمين"})]})}),e.jsx("td",{className:"py-2 px-2 md:px-4 text-xs md:text-sm text-foreground hidden lg:table-cell",children:e.jsx("div",{className:"max-w-xs",children:t.target==="admin"&&(!t.recipients||t.recipients.length===0)?"جميع المشرفين":t.recipients&&t.recipients.length>0?e.jsx("div",{className:"truncate",children:t.recipients.map(x=>{const m=l==null?void 0:l.find(c=>c.id===x);if(m)return`${m.username} (${m.phone||"بدون رقم"})`;const n=a==null?void 0:a.find(c=>c.userId===x);return n?`${n.husbandName} (${n.husbandID})`:x}).join(", ")}):"جميع المستخدمين"})}),e.jsx("td",{className:"py-2 px-2 md:px-4 text-xs md:text-sm text-muted-foreground hidden sm:table-cell",children:new Date(t.createdAt).toLocaleString("ar-EG",{dateStyle:"short",timeStyle:"short"})}),e.jsx("td",{className:"py-2 px-2 md:px-4 text-xs md:text-sm text-foreground hidden xl:table-cell",children:"الإدارة"})]},t.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(C,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"لا توجد تنبيهات"})]})})]})]})})}export{q as default};
