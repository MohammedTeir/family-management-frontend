import{t as D,r as u,b as R,c as A,v as F,w as E,j as e,B as n,C as m,d as i,e as P,f as B,s as I,o as V,P as p,x as h,S as H,m as O,n as K,p as L,q as d,A as M,D as Q,z,E as G,G as X,F as _}from"./index-BRVCUzIT.js";import{T as J}from"./textarea-D5X74VJL.js";import{D as U,a as W,b as Y,c as Z}from"./dialog-D51Jx8ed.js";import{a as $}from"./dropdown-menu-DdnnckdS.js";import{H as g}from"./header--JBEaVK1.js";import{P as q}from"./plus-B3M91HrX.js";import{F as j}from"./file-text-Bxr2bFQ2.js";import{C as x}from"./clock-eFLI6NpM.js";import{C as f}from"./circle-check-big-DIzHHyic.js";import{C as N}from"./circle-x-Cp3bohXm.js";import"./index-uwi08Yf3.js";const ee=G({type:_(["financial","medical","damage"],{required_error:"نوع الطلب مطلوب"}),description:X().min(10,"الوصف يجب أن يكون 10 أحرف على الأقل")});function ue(){const{toast:o}=D(),[b,l]=u.useState(!1),{settings:r}=R();u.useEffect(()=>{r.siteTitle&&(document.title=r.siteTitle),r.language&&(document.documentElement.lang=r.language,document.body.dir=r.language==="ar"?"rtl":"ltr")},[r.siteTitle,r.language]);const{data:t,isLoading:v}=A({queryKey:["/api/requests"]}),a=F({resolver:M(ee),defaultValues:{type:"financial",description:""}}),c=E({mutationFn:async s=>(await z("POST","/api/requests",s)).data,onSuccess:()=>{Q.invalidateQueries({queryKey:["/api/requests"]}),l(!1),a.reset(),o({title:"تم تقديم الطلب بنجاح",description:"سيتم مراجعة طلبكم والرد عليه قريباً"})},onError:s=>{o({title:"خطأ في تقديم الطلب",description:s.message,variant:"destructive"})}}),w=s=>{c.mutate(s)},y=s=>{switch(s){case"pending":return e.jsx(x,{className:"h-4 w-4 text-warning"});case"approved":return e.jsx(f,{className:"h-4 w-4 text-secondary"});case"rejected":return e.jsx(N,{className:"h-4 w-4 text-destructive"});default:return e.jsx(x,{className:"h-4 w-4 text-muted-foreground"})}},C=s=>{switch(s){case"pending":return"default";case"approved":return"default";case"rejected":return"destructive";default:return"outline"}};if(v)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(g,{}),e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg text-muted-foreground",children:"جاري تحميل البيانات..."})})]});const S=(t==null?void 0:t.filter(s=>s.status==="pending"))||[],T=(t==null?void 0:t.filter(s=>s.status==="approved"))||[],k=(t==null?void 0:t.filter(s=>s.status==="rejected"))||[];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(g,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-foreground mb-2",children:"الطلبات"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"تقديم ومتابعة الطلبات والخدمات"})]}),e.jsxs(n,{onClick:()=>l(!0),className:"flex items-center gap-2 w-full sm:w-auto justify-center text-sm sm:text-base",children:[e.jsx(q,{className:"h-4 w-4"}),"تقديم طلب جديد"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(m,{children:e.jsx(i,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 sm:h-6 sm:w-6 text-primary"})}),e.jsxs("div",{className:"mr-3 sm:mr-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"إجمالي الطلبات"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-foreground",children:(t==null?void 0:t.length)||0})]})]})})}),e.jsx(m,{children:e.jsx(i,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 sm:p-3 bg-yellow-100 rounded-lg",children:e.jsx(x,{className:"h-5 w-5 sm:h-6 sm:w-6 text-warning"})}),e.jsxs("div",{className:"mr-3 sm:mr-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"قيد المراجعة"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-foreground",children:S.length})]})]})})}),e.jsx(m,{children:e.jsx(i,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 sm:p-3 bg-green-100 rounded-lg",children:e.jsx(f,{className:"h-5 w-5 sm:h-6 sm:w-6 text-secondary"})}),e.jsxs("div",{className:"mr-3 sm:mr-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"موافق عليها"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-foreground",children:T.length})]})]})})}),e.jsx(m,{children:e.jsx(i,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 sm:p-3 bg-red-100 rounded-lg",children:e.jsx(N,{className:"h-5 w-5 sm:h-6 sm:w-6 text-destructive"})}),e.jsxs("div",{className:"mr-3 sm:mr-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"مرفوضة"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-foreground",children:k.length})]})]})})})]}),e.jsxs(m,{children:[e.jsx(P,{children:e.jsx(B,{className:"text-lg sm:text-xl",children:"قائمة الطلبات"})}),e.jsx(i,{children:t&&t.length>0?e.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6 hover:bg-background",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[y(s.status),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground",children:I(s.type)})]}),e.jsx($,{variant:C(s.status),className:"text-xs w-fit",children:V(s.status)})]}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3 break-words",children:s.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("span",{children:["تاريخ التقديم: ",p(s.createdAt)]}),s.updatedAt!==s.createdAt&&e.jsxs("span",{children:["آخر تحديث: ",p(s.updatedAt)]})]}),s.adminComment&&e.jsxs("div",{className:"mt-3 sm:mt-4 p-3 bg-blue-50 rounded-lg border-r-4 border-primary",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-foreground",children:"تعليق الإدارة:"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-700 mt-1 break-words",children:s.adminComment})]})]})})},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-4",children:"لم تقم بتقديم أي طلبات بعد"}),e.jsx(n,{onClick:()=>l(!0),className:"w-full sm:w-auto text-sm sm:text-base",children:"تقديم طلب جديد"})]})})]}),e.jsx(U,{open:b,onOpenChange:l,children:e.jsxs(W,{className:"max-w-md mx-4",children:[e.jsx(Y,{children:e.jsx(Z,{className:"text-lg sm:text-xl",children:"تقديم طلب جديد"})}),e.jsxs("form",{onSubmit:a.handleSubmit(w),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"type",className:"text-sm sm:text-base",children:"نوع الطلب *"}),e.jsxs(H,{value:a.watch("type"),onValueChange:s=>a.setValue("type",s),children:[e.jsx(O,{className:"text-sm sm:text-base",children:e.jsx(K,{})}),e.jsxs(L,{children:[e.jsx(d,{value:"financial",children:"مساعدة مالية"}),e.jsx(d,{value:"medical",children:"مساعدة طبية"}),e.jsx(d,{value:"damage",children:"تقرير أضرار"})]})]}),a.formState.errors.type&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.type.message})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"description",className:"text-sm sm:text-base",children:"وصف الطلب *"}),e.jsx(J,{id:"description",rows:4,placeholder:"يرجى وصف طلبكم بالتفصيل...",className:"text-sm sm:text-base",...a.register("description")}),a.formState.errors.description&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:a.formState.errors.description.message})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 sm:gap-2 pt-4",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>l(!1),className:"w-full sm:w-auto text-sm sm:text-base order-2 sm:order-1",children:"إلغاء"}),e.jsx(n,{type:"submit",disabled:c.isPending,className:"w-full sm:w-auto text-sm sm:text-base order-1 sm:order-2",children:c.isPending?"جاري التقديم...":"تقديم الطلب"})]})]})]})})]})]})}export{ue as default};
