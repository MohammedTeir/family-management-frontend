import{a as De,t as Te,r as u,c as Se,w as J,j as e,B as N,C as H,e as W,f as A,d as B,x as a,I as l,S as G,m as O,n as V,p as R,q as C,g as Fe,k as ke,h as He,U as Ne,y as ie,N as ve,M as ne,D as K,O as E,E as We,G as v,F as ye,v as Ae,A as Be}from"./index-ZYzdAsGm.js";import{T as we,a as Me,b as ue,c as fe}from"./tabs-mAKK4uFS.js";import{S as w}from"./switch-DBFXyOxO.js";import{a as I}from"./dropdown-menu-C5FzIU9D.js";import{c as $e}from"./image-compression-C0mNLyVZ.js";import{P as pe}from"./page-wrapper-DEQQYva8.js";import{A as Ee}from"./arrow-left-HiVoEJvR.js";import{P as Ie}from"./plus-hSYWIs9K.js";import{P as me,T as de}from"./trash-2-BvJN9095.js";import"./index-CvI2JamZ.js";import"./baby-B20HtjzY.js";import"./file-text-WTwHpCUH.js";const je=[{value:"abushalbia",label:"ابو شلبية (شلف - علاينة - عزايزة)"},{value:"alnaqra",label:"النقرة (الدوار)"},{value:"abuawda",label:"ابو عودة"},{value:"abunasr",label:"ابو نصر"},{value:"abumatar",label:"ابو مطر"}],_e=[{value:"married",label:"متزوج"},{value:"polygamous",label:"متعدد زوجات"},{value:"widowed",label:"ارملة"},{value:"vulnerable_family",label:"اسر هشة (ايتام)"},{value:"abandoned",label:"متروكة"},{value:"divorced",label:"مطلقة"},{value:"single",label:"عانس"}],Pe=[{value:"total_destruction_uninhabitable",label:"هدم كلي غير قابل للسكن"},{value:"partial_destruction_habitable",label:"هدم جزئي قابل للسكن"},{value:"minor_damage",label:"أضرار بسيطة"}],ce=[{value:"son",label:"ابن"},{value:"daughter",label:"ابنة"},{value:"mother",label:"أم"},{value:"father",label:"أب"},{value:"brother",label:"أخ"},{value:"sister",label:"أخت"},{value:"grandfather",label:"جد"},{value:"grandmother",label:"جدة"},{value:"uncle",label:"عم"},{value:"aunt",label:"عمة"},{value:"other",label:"أخرى"}];function es({params:i}){const g=i==null?void 0:i.id,[,Z]=De(),{toast:p}=Te(),[_,L]=u.useState("family"),[r,F]=u.useState(null),[j,b]=u.useState(!1),[M,k]=u.useState(""),[D,Q]=u.useState(!1),[re,P]=u.useState(!1),[z,n]=u.useState(""),[q,f]=u.useState(!1),[ee,U]=u.useState(""),{data:c,isLoading:ae,refetch:T}=Se({queryKey:["/api/admin/families",g],queryFn:async()=>(await E.get(`/api/admin/families/${g}`)).data,enabled:!!g}),se=J({mutationFn:async s=>{const{wives:m,userGender:Y,...d}=s;d.wifeName===""&&(d.wifeName=null),d.wifeID===""&&(d.wifeID=null),d.wifeBirthDate===""&&(d.wifeBirthDate=null),d.wifeJob===""&&(d.wifeJob=null),d.hasChronicIllness===void 0&&(d.hasChronicIllness=!1),d.hasChronicIllness===!1&&(d.chronicIllnessType=null),d.wifeHasChronicIllness===void 0&&(d.wifeHasChronicIllness=!1),d.wifeHasChronicIllness===!1&&(d.wifeChronicIllnessType=null),d.hasDisability===void 0&&(d.hasDisability=!1),d.hasDisability===!1&&(d.disabilityType=null),d.wifeHasDisability===void 0&&(d.wifeHasDisability=!1),d.wifeHasDisability===!1&&(d.wifeDisabilityType=null),d.hasWarInjury===void 0&&(d.hasWarInjury=!1),d.hasWarInjury===!1&&(d.warInjuryType=null),d.wifeHasWarInjury===void 0&&(d.wifeHasWarInjury=!1),d.wifeHasWarInjury===!1&&(d.wifeWarInjuryType=null);const oe=await E.put(`/api/admin/families/${g}`,d);if(Y!==void 0&&(c!=null&&c.userId))try{await E.put(`/api/admin/users/${c.userId}`,{gender:Y})}catch(he){console.error("Error updating user gender:",he)}return oe.data},onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/families",g]}),p({title:"تم التحديث بنجاح",description:"تم حفظ بيانات الأسرة"}),T()},onError:s=>{p({title:"خطأ في التحديث",description:s.message,variant:"destructive"})}}),X=J({mutationFn:async s=>(s.relationship==="other"&&(s.relationship=M),s.isDisabled&&s.disabilityType==="custom"&&(s.disabilityType=z),(await E.post(`/api/admin/families/${g}/members`,s)).data),onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/families",g]}),p({title:"تمت إضافة الفرد",description:"تمت إضافة الفرد بنجاح"}),b(!1),F(null),T()},onError:s=>{p({title:"خطأ في الإضافة",description:s.message,variant:"destructive"})}}),te=J({mutationFn:async({memberId:s,data:m})=>(m.relationship==="other"&&(m.relationship=M),m.isDisabled&&m.disabilityType==="custom"&&(m.disabilityType=z),(await E.put(`/api/members/${s}`,m)).data),onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/families",g]}),p({title:"تم التحديث",description:"تم تحديث بيانات الفرد"}),b(!1),F(null),T()},onError:s=>{p({title:"خطأ في التحديث",description:s.message,variant:"destructive"})}}),x=J({mutationFn:async s=>(await E.delete(`/api/members/${s}`),s),onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/families",g]}),p({title:"تم الحذف",description:"تم حذف الفرد بنجاح"}),T()},onError:s=>{p({title:"خطأ في الحذف",description:s.message,variant:"destructive"})}}),[h,$]=u.useState(null),[xe,S]=u.useState(!1),le=J({mutationFn:async s=>(await E.post("/api/orphans",{...s,familyId:Number(g)})).data,onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/families",g]}),p({title:"تمت إضافة اليتيم",description:"تمت إضافة اليتيم بنجاح"}),S(!1),$(null),T()},onError:s=>{p({title:"خطأ في الإضافة",description:s.message,variant:"destructive"})}}),ge=J({mutationFn:async({orphanId:s,data:m})=>(await E.put(`/api/orphans/${s}`,m)).data,onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/families",g]}),p({title:"تم التحديث",description:"تم تحديث بيانات اليتيم"}),S(!1),$(null),T()},onError:s=>{p({title:"خطأ في التحديث",description:s.message,variant:"destructive"})}}),be=J({mutationFn:async s=>(await E.delete(`/api/orphans/${s}`),s),onSuccess:()=>{K.invalidateQueries({queryKey:["/api/admin/families",g]}),p({title:"تم الحذف",description:"تم حذف اليتيم بنجاح"}),T()},onError:s=>{p({title:"خطأ في الحذف",description:s.message,variant:"destructive"})}});u.useEffect(()=>{r?(Q(!ce.some(s=>s.value===r.relationship)),k(r.relationship&&!ce.some(s=>s.value===r.relationship)?r.relationship:""),P(r.isDisabled),n(r.disabilityType||"")):(Q(!1),k(""),P(!1),n(""))},[r]);const[t,y]=u.useState(null);u.useEffect(()=>{c&&y({...c,hasChronicIllness:c.hasChronicIllness||!1,wifeHasChronicIllness:c.wifeHasChronicIllness||!1,hasDisability:c.hasDisability||!1,wifeHasDisability:c.wifeHasDisability||!1,hasWarInjury:c.hasWarInjury||!1,wifeHasWarInjury:c.wifeHasWarInjury||!1})},[c]),u.useEffect(()=>{r&&(r.isDisabled?(n(r.disabilityType||""),P(!0)):(n(""),P(!1)),r.hasChronicIllness?(U(r.chronicIllnessType||""),f(!0)):(U(""),f(!1)))},[r]);function o(s){const{name:m,value:Y,type:d,checked:oe}=s.target;y(he=>({...he,[m]:d==="checkbox"?oe:Y}))}function Ce(s){s.preventDefault(),se.mutate({...t,branch:t.branch})}return ae||!t?e.jsx(pe,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg text-muted-foreground",children:"جاري تحميل بيانات الأسرة..."})})}):c?e.jsx(pe,{children:e.jsxs("div",{className:"space-y-6",dir:"rtl",children:[e.jsx("div",{className:"flex flex-row-reverse justify-end mb-4 w-full",children:e.jsxs(N,{variant:"ghost",onClick:()=>Z("/admin/families"),className:"flex flex-row-reverse items-center",children:[e.jsx(Ee,{className:"h-5 w-5 ml-2"})," عودة لقائمة الأسر"]})}),e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row-reverse md:items-center md:justify-between w-full gap-4",children:[e.jsx("div",{className:"flex flex-row-reverse items-center gap-4",children:e.jsxs("h1",{className:"text-lg md:text-2xl font-bold text-foreground ml-2 md:ml-4",children:["تعديل بيانات الأسرة ",e.jsxs(I,{className:"bg-blue-100 text-blue-800 text-xs md:text-sm",children:["#",c.id]})]})}),e.jsx(we,{value:_,onValueChange:L,className:"mb-0 w-full md:w-auto",children:e.jsxs(Me,{className:"flex flex-row-reverse gap-1 md:gap-2 w-full md:w-auto",children:[e.jsx(ue,{value:"family",className:"text-xs md:text-sm flex-1 md:flex-none",children:"بيانات الأسرة"}),e.jsx(ue,{value:"members",className:"text-xs md:text-sm flex-1 md:flex-none",children:"أفراد الأسرة"}),e.jsx(ue,{value:"orphans",className:"text-xs md:text-sm flex-1 md:flex-none",children:"الأيتام"})]})})]}),e.jsxs(we,{value:_,onValueChange:L,className:"mb-8",children:[e.jsx(fe,{value:"family",children:e.jsxs(H,{className:"mb-8 border-blue-200 shadow-md",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-4",children:e.jsxs(A,{className:"flex items-center gap-2 text-blue-900",children:["تعديل بيانات الأسرة ",e.jsxs(I,{className:"bg-blue-200 text-blue-900",children:["#",c.id]})]})}),e.jsx(B,{children:e.jsxs("form",{id:"family-form",onSubmit:Ce,className:"space-y-6 md:space-y-8",children:[e.jsxs(H,{className:"border-indigo-200 shadow-sm",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(A,{className:"text-indigo-700 text-base md:text-lg",children:t.userGender==="female"?"بيانات ربة الأسرة":"بيانات رب الأسرة"})}),e.jsx(B,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"husbandName",className:"text-right w-full mb-1",children:"الاسم الرباعي *"}),e.jsx(l,{id:"husbandName",name:"husbandName",value:t.husbandName||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"husbandID",className:"text-right w-full mb-1",children:"رقم الهوية *"}),e.jsx(l,{id:"husbandID",name:"husbandID",value:t.husbandID||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"husbandBirthDate",className:"text-right w-full mb-1",children:"تاريخ الميلاد *"}),e.jsx(l,{id:"husbandBirthDate",name:"husbandBirthDate",type:"date",value:t.husbandBirthDate||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"husbandJob",className:"text-right w-full mb-1",children:"المهنة *"}),e.jsx(l,{id:"husbandJob",name:"husbandJob",value:t.husbandJob||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"headGender",className:"text-right w-full mb-1",children:"جنس رب/ربة الأسرة"}),e.jsxs(G,{dir:"rtl",value:t.userGender||(c==null?void 0:c.userGender)||"male",onValueChange:s=>y(m=>({...m,userGender:s})),children:[e.jsx(O,{className:"text-right w-full",dir:"rtl",children:e.jsx(V,{placeholder:"اختر الجنس"})}),e.jsxs(R,{dir:"rtl",children:[e.jsx(C,{value:"male",children:"ذكر (رب أسرة)"}),e.jsx(C,{value:"female",children:"أنثى (ربة أسرة)"})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"primaryPhone",className:"text-right w-full mb-1",children:"رقم الجوال الأساسي *"}),e.jsx(l,{id:"primaryPhone",name:"primaryPhone",value:t.primaryPhone||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"secondaryPhone",className:"text-right w-full mb-1",children:"رقم الجوال البديل"}),e.jsx(l,{id:"secondaryPhone",name:"secondaryPhone",value:t.secondaryPhone||"",onChange:o,className:"text-right mt-1"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasChronicIllness",name:"hasChronicIllness",checked:!!t.hasChronicIllness,onCheckedChange:s=>y(m=>({...m,hasChronicIllness:s}))}),e.jsx(a,{htmlFor:"hasChronicIllness",className:"cursor-pointer",children:"يعاني من مرض مزمن"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasDisability",name:"hasDisability",checked:!!t.hasDisability,onCheckedChange:s=>y(m=>({...m,hasDisability:s}))}),e.jsx(a,{htmlFor:"hasDisability",className:"cursor-pointer",children:"يعاني من إعاقة"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasWarInjury",name:"hasWarInjury",checked:!!t.hasWarInjury,onCheckedChange:s=>y(m=>({...m,hasWarInjury:s}))}),e.jsx(a,{htmlFor:"hasWarInjury",className:"cursor-pointer",children:"يعاني من إصابة حرب"})]})})]}),t.hasChronicIllness&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"chronicIllnessType",className:"text-right w-full mb-1",children:"نوع المرض المزمن"}),e.jsx(l,{id:"chronicIllnessType",name:"chronicIllnessType",value:t.chronicIllnessType||"",onChange:o,className:"text-right max-w-md w-full"})]}),t.hasDisability&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"disabilityType",className:"text-right w-full mb-1",children:"نوع الإعاقة"}),e.jsx(l,{id:"disabilityType",name:"disabilityType",value:t.disabilityType||"",onChange:o,className:"text-right max-w-md w-full"})]}),t.hasWarInjury&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"warInjuryType",className:"text-right w-full mb-1",children:"نوع إصابة الحرب"}),e.jsx(l,{id:"warInjuryType",name:"warInjuryType",value:t.warInjuryType||"",onChange:o,className:"text-right max-w-md w-full"})]})]})]})})]}),e.jsxs(H,{className:"border-teal-200 shadow-sm",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(A,{className:"text-teal-700 text-base md:text-lg",children:t.userGender==="female"?"بيانات الزوج":"بيانات الزوجة"})}),e.jsx(B,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"wifeName",className:"text-right w-full mb-1",children:"الاسم الرباعي"}),e.jsx(l,{id:"wifeName",name:"wifeName",value:t.wifeName||"",onChange:o,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"wifeID",className:"text-right w-full mb-1",children:"رقم الهوية"}),e.jsx(l,{id:"wifeID",name:"wifeID",value:t.wifeID||"",onChange:o,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"wifeBirthDate",className:"text-right w-full mb-1",children:"تاريخ الميلاد"}),e.jsx(l,{id:"wifeBirthDate",name:"wifeBirthDate",type:"date",value:t.wifeBirthDate||"",onChange:o,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"wifeJob",className:"text-right w-full mb-1",children:"المهنة"}),e.jsx(l,{id:"wifeJob",name:"wifeJob",value:t.wifeJob||"",onChange:o,className:"text-right mt-1"})]}),t.userGender!=="female"?e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasChronicIllness",name:"wifeHasChronicIllness",checked:!!t.wifeHasChronicIllness,onCheckedChange:s=>y(m=>({...m,wifeHasChronicIllness:s}))}),e.jsx(a,{htmlFor:"wifeHasChronicIllness",className:"cursor-pointer",children:t.userGender==="female"?"يعاني من مرض مزمن":"تعاني من مرض مزمن"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasDisability",name:"wifeHasDisability",checked:!!t.wifeHasDisability,onCheckedChange:s=>y(m=>({...m,wifeHasDisability:s}))}),e.jsx(a,{htmlFor:"wifeHasDisability",className:"cursor-pointer",children:t.userGender==="female"?"يعاني من إعاقة":"تعاني من إعاقة"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasWarInjury",name:"wifeHasWarInjury",checked:!!t.wifeHasWarInjury,onCheckedChange:s=>y(m=>({...m,wifeHasWarInjury:s}))}),e.jsx(a,{htmlFor:"wifeHasWarInjury",className:"cursor-pointer",children:t.userGender==="female"?"يعاني من إصابة حرب":"تعاني من إصابة حرب"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifePregnant",name:"wifePregnant",checked:!!t.wifePregnant,onCheckedChange:s=>y(m=>({...m,wifePregnant:s}))}),e.jsx(a,{htmlFor:"wifePregnant",className:"cursor-pointer",children:"حامل"})]})})]}),t.wifeHasChronicIllness&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"wifeChronicIllnessType",className:"text-right w-full mb-1",children:"نوع المرض المزمن"}),e.jsx(l,{id:"wifeChronicIllnessType",name:"wifeChronicIllnessType",value:t.wifeChronicIllnessType||"",onChange:o,className:"text-right max-w-md w-full"})]}),t.wifeHasDisability&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"wifeDisabilityType",className:"text-right w-full mb-1",children:"نوع الإعاقة"}),e.jsx(l,{id:"wifeDisabilityType",name:"wifeDisabilityType",value:t.wifeDisabilityType||"",onChange:o,className:"text-right max-w-md w-full"})]}),t.wifeHasWarInjury&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"wifeWarInjuryType",className:"text-right w-full mb-1",children:"نوع إصابة الحرب"}),e.jsx(l,{id:"wifeWarInjuryType",name:"wifeWarInjuryType",value:t.wifeWarInjuryType||"",onChange:o,className:"text-right max-w-md w-full"})]})]}):e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasChronicIllness",name:"wifeHasChronicIllness",checked:!!t.wifeHasChronicIllness,onCheckedChange:s=>y(m=>({...m,wifeHasChronicIllness:s}))}),e.jsx(a,{htmlFor:"wifeHasChronicIllness",className:"cursor-pointer",children:t.userGender==="female"?"يعاني من مرض مزمن":"تعاني من مرض مزمن"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasDisability",name:"wifeHasDisability",checked:!!t.wifeHasDisability,onCheckedChange:s=>y(m=>({...m,wifeHasDisability:s}))}),e.jsx(a,{htmlFor:"wifeHasDisability",className:"cursor-pointer",children:t.userGender==="female"?"يعاني من إعاقة":"تعاني من إعاقة"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"wifeHasWarInjury",name:"wifeHasWarInjury",checked:!!t.wifeHasWarInjury,onCheckedChange:s=>y(m=>({...m,wifeHasWarInjury:s}))}),e.jsx(a,{htmlFor:"wifeHasWarInjury",className:"cursor-pointer",children:t.userGender==="female"?"يعاني من إصابة حرب":"تعاني من إصابة حرب"})]})})]}),t.wifeHasChronicIllness&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"wifeChronicIllnessType",className:"text-right w-full mb-1",children:"نوع المرض المزمن"}),e.jsx(l,{id:"wifeChronicIllnessType",name:"wifeChronicIllnessType",value:t.wifeChronicIllnessType||"",onChange:o,className:"text-right max-w-md w-full"})]}),t.wifeHasDisability&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"wifeDisabilityType",className:"text-right w-full mb-1",children:"نوع الإعاقة"}),e.jsx(l,{id:"wifeDisabilityType",name:"wifeDisabilityType",value:t.wifeDisabilityType||"",onChange:o,className:"text-right max-w-md w-full"})]}),t.wifeHasWarInjury&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"wifeWarInjuryType",className:"text-right w-full mb-1",children:"نوع إصابة الحرب"}),e.jsx(l,{id:"wifeWarInjuryType",name:"wifeWarInjuryType",value:t.wifeWarInjuryType||"",onChange:o,className:"text-right max-w-md w-full"})]})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{className:"border-blue-200 shadow-sm",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(A,{className:"text-blue-700 text-base md:text-lg",children:"بيانات السكن"})}),e.jsx(B,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"originalResidence",className:"text-right w-full mb-1",children:"السكن الأصلي *"}),e.jsx(l,{id:"originalResidence",name:"originalResidence",value:t.originalResidence||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"currentHousing",className:"text-right w-full mb-1",children:"السكن الحالي *"}),e.jsx(l,{id:"currentHousing",name:"currentHousing",value:t.currentHousing||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"landmarkNear",className:"text-right w-full mb-1",children:"أقرب معلم"}),e.jsx(l,{id:"landmarkNear",name:"landmarkNear",value:t.landmarkNear||"",onChange:o,className:"text-right mt-1"})]})]})})]}),e.jsxs(H,{className:"border-purple-200 shadow-sm",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(A,{className:"text-purple-700 text-base md:text-lg",children:"المعلومات التنظيمية"})}),e.jsx(B,{className:"pt-3 pb-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-6",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"branch",className:"text-right w-full mb-1",children:"الفرع"}),e.jsxs(G,{value:je.some(s=>s.value===t.branch)?t.branch:"",onValueChange:s=>o({target:{name:"branch",value:s}}),dir:"rtl",children:[e.jsx(O,{className:"text-right w-full max-w-md",children:e.jsx(V,{placeholder:"اختر الفرع"})}),e.jsx(R,{dir:"rtl",children:je.map(s=>e.jsx(C,{value:s.value,children:Fe(s.value)},s.value))})]}),je.some(s=>s.value===t.branch)?null:e.jsx("div",{className:"mt-2 flex flex-col items-end",children:e.jsx(l,{className:"text-right max-w-md",placeholder:"قيمة فرع غير صحيحة",value:t.branch,disabled:!0})})]})})})]}),e.jsxs(H,{className:"border-orange-200 shadow-sm",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(A,{className:"text-orange-700 text-base md:text-lg",children:"المعلومات الشخصية والاجتماعية"})}),e.jsx(B,{className:"pt-3 pb-4",children:e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-6",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"socialStatus",className:"text-right w-full mb-1",children:"الحالة الاجتماعية"}),e.jsxs(G,{value:t.socialStatus||"",onValueChange:s=>o({target:{name:"socialStatus",value:s}}),dir:"rtl",children:[e.jsx(O,{className:"text-right w-full max-w-md",children:e.jsx(V,{placeholder:"اختر الحالة"})}),e.jsx(R,{dir:"rtl",children:_e.map(s=>e.jsx(C,{value:s.value,children:ke(s.value)},s.value))})]})]})})})]}),e.jsxs(H,{className:"border-red-200 shadow-sm",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(A,{className:"text-red-700 text-base md:text-lg",children:"المعلومات الاجتماعية والمعيشية"})}),e.jsx(B,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"warDamageDescription",className:"text-right w-full mb-1",children:"وصف الضرر"}),e.jsxs(G,{value:t.warDamageDescription||"",onValueChange:s=>o({target:{name:"warDamageDescription",value:s}}),dir:"rtl",className:"w-full max-w-md",children:[e.jsx(O,{className:"text-right",children:e.jsx(V,{placeholder:"اختر وصف الضرر"})}),e.jsx(R,{dir:"rtl",children:Pe.map(s=>e.jsx(C,{value:s.value,children:He(s.value)},s.value))})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"isDisplaced",name:"isDisplaced",checked:!!t.isDisplaced,onCheckedChange:s=>y(m=>({...m,isDisplaced:s}))}),e.jsx(a,{htmlFor:"isDisplaced",className:"cursor-pointer",children:"نازح؟"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"isAbroad",name:"isAbroad",checked:!!t.isAbroad,onCheckedChange:s=>y(m=>({...m,isAbroad:s}))}),e.jsx(a,{htmlFor:"isAbroad",className:"cursor-pointer",children:"مغترب؟"})]})})]}),t.isDisplaced&&e.jsxs("div",{className:"flex flex-col items-end mt-4",children:[e.jsx(a,{htmlFor:"displacedLocation",className:"text-right w-full mb-1",children:"مكان النزوح"}),e.jsx(l,{id:"displacedLocation",name:"displacedLocation",value:t.displacedLocation||"",onChange:o,className:"text-right max-w-md w-full"})]})]})})]}),e.jsxs(H,{className:"border-green-200 shadow-sm",children:[e.jsx(W,{className:"flex flex-row-reverse items-center gap-2 py-3",children:e.jsx(A,{className:"text-green-700 text-base md:text-lg",children:"أفراد الأسرة"})}),e.jsx(B,{className:"pt-3 pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"totalMembers",className:"text-right w-full mb-1",children:"عدد الأفراد *"}),e.jsx(l,{id:"totalMembers",name:"totalMembers",value:t.totalMembers||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"numMales",className:"text-right w-full mb-1",children:"عدد الذكور *"}),e.jsx(l,{id:"numMales",name:"numMales",value:t.numMales||"",onChange:o,required:!0,className:"text-right mt-1"})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(a,{htmlFor:"numFemales",className:"text-right w-full mb-1",children:"عدد الإناث *"}),e.jsx(l,{id:"numFemales",name:"numFemales",value:t.numFemales||"",onChange:o,required:!0,className:"text-right mt-1"})]})]})})]})]}),e.jsx("div",{className:"flex justify-end mt-6 md:mt-8",children:e.jsx(N,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",disabled:se.isPending,children:se.isPending?"جاري الحفظ...":"حفظ التعديلات"})})]})})]})}),e.jsx(fe,{value:"members",children:e.jsxs(H,{className:"border-green-200 shadow-md",children:[e.jsxs(W,{className:"flex flex-col sm:flex-row-reverse sm:items-center sm:justify-between gap-4",children:[e.jsxs(A,{className:"flex items-center gap-2 text-green-900 text-base md:text-lg",children:[e.jsx(Ne,{className:"h-5 w-5 ml-1 text-green-600"})," أفراد الأسرة"]}),e.jsxs(N,{onClick:()=>{F(null),b(!0)},className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto text-sm",children:[e.jsx(Ie,{className:"h-4 w-4 ml-2"})," إضافة فرد"]})]}),e.jsxs(B,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-background",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"الإجراءات"}),e.jsx("th",{className:"px-3 py-2",children:"العمر"}),e.jsx("th",{className:"px-3 py-2",children:"تاريخ الميلاد"}),e.jsx("th",{className:"px-3 py-2",children:"القرابة"}),e.jsx("th",{className:"px-3 py-2",children:"الجنس"}),e.jsx("th",{className:"px-3 py-2",children:"الاسم"}),e.jsx("th",{className:"px-3 py-2",children:"الهوية"})]})}),e.jsx("tbody",{children:c.members&&c.members.length>0?c.members.map(s=>e.jsxs("tr",{className:"border-b hover:bg-background",children:[e.jsxs("td",{className:"px-3 py-2 flex gap-2 justify-end",children:[e.jsx(N,{size:"sm",variant:"outline",onClick:()=>{F(s),b(!0)},children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(N,{size:"sm",variant:"destructive",onClick:()=>x.mutate(s.id),children:e.jsx(de,{className:"h-4 w-4"})})]}),e.jsx("td",{className:"px-3 py-2",children:s.birthDate?e.jsx(I,{className:"bg-green-100 text-green-800",children:ie(s.birthDate)}):"-"}),e.jsx("td",{className:"px-3 py-2",children:s.birthDate||"غير محدد"}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(I,{className:"bg-muted text-foreground",children:ve(s.relationship)})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(I,{className:s.gender==="male"?"bg-blue-100 text-blue-800":"bg-pink-100 text-pink-800",children:ne(s.gender)})}),e.jsx("td",{className:"px-3 py-2 font-medium",children:s.fullName}),e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:s.memberID||"غير محدد"})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-muted-foreground py-4",children:"لا يوجد أفراد مسجلين لهذه الأسرة."})})})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:c.members&&c.members.length>0?c.members.map(s=>e.jsx("div",{className:"bg-muted/30 rounded-lg p-4 space-y-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:s.memberID||"غير محدد"}),e.jsx("h4",{className:"font-medium text-sm",children:s.fullName})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(I,{className:s.gender==="male"?"bg-blue-100 text-blue-800 text-xs":"bg-pink-100 text-pink-800 text-xs",children:ne(s.gender)}),e.jsx(I,{className:"bg-muted text-foreground text-xs",children:ve(s.relationship)}),s.birthDate&&e.jsx(I,{className:"bg-green-100 text-green-800 text-xs",children:ie(s.birthDate)})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["رقم الهوية: ",s.memberID||"غير محدد"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["تاريخ الميلاد: ",s.birthDate||"غير محدد"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{size:"sm",variant:"outline",onClick:()=>{F(s),b(!0)},className:"p-2",children:e.jsx(me,{className:"h-3 w-3"})}),e.jsx(N,{size:"sm",variant:"destructive",onClick:()=>x.mutate(s.id),className:"p-2",children:e.jsx(de,{className:"h-3 w-3"})})]})]})},s.id)):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"لا يوجد أفراد مسجلين لهذه الأسرة."})}),j&&e.jsx(qe,{initialData:r,onSubmit:r?s=>te.mutate({memberId:r.id,data:s}):X.mutate,isLoading:X.isPending||te.isPending,isEdit:!!r,onCancel:()=>{b(!1),F(null)},customRelationship:M,setCustomRelationship:k,showCustomRelationship:D,setShowCustomRelationship:Q,showDisabilityType:re,setShowDisabilityType:P,customDisabilityType:z,setCustomDisabilityType:n,showChronicIllnessType:q,setShowChronicIllnessType:f,customChronicIllnessType:ee,setCustomChronicIllnessType:U})]})]})}),e.jsx(fe,{value:"orphans",children:e.jsxs(H,{className:"border-purple-200 shadow-md",children:[e.jsxs(W,{className:"flex flex-col sm:flex-row-reverse sm:items-center sm:justify-between gap-4",children:[e.jsxs(A,{className:"flex items-center gap-2 text-purple-900 text-base md:text-lg",children:[e.jsx(Ne,{className:"h-5 w-5 ml-1 text-purple-600"})," الأيتام"]}),e.jsxs(N,{onClick:()=>{$(null),S(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white w-full sm:w-auto text-sm",children:[e.jsx(Ie,{className:"h-4 w-4 ml-2"})," إضافة يتيم"]})]}),e.jsxs(B,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-background",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"الإجراءات"}),e.jsx("th",{className:"px-3 py-2",children:"الجنس"}),e.jsx("th",{className:"px-3 py-2",children:"العمر"}),e.jsx("th",{className:"px-3 py-2",children:"تاريخ الميلاد"}),e.jsx("th",{className:"px-3 py-2",children:"حالة الوفاة"}),e.jsx("th",{className:"px-3 py-2",children:"اسم الوصي"}),e.jsx("th",{className:"px-3 py-2",children:"الاسم"}),e.jsx("th",{className:"px-3 py-2",children:"الهوية"})]})}),e.jsx("tbody",{children:c.orphans&&c.orphans.length>0?c.orphans.map(s=>e.jsxs("tr",{className:"border-b hover:bg-background",children:[e.jsxs("td",{className:"px-3 py-2 flex gap-2 justify-end",children:[e.jsx(N,{size:"sm",variant:"outline",onClick:()=>{$(s),S(!0)},children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(N,{size:"sm",variant:"destructive",onClick:()=>be.mutate(s.id),children:e.jsx(de,{className:"h-4 w-4"})})]}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(I,{className:s.gender==="male"?"bg-blue-100 text-blue-800":"bg-pink-100 text-pink-800",children:ne(s.gender)||"غير محدد"})}),e.jsx("td",{className:"px-3 py-2",children:s.orphanBirthDate?e.jsx(I,{className:"bg-purple-100 text-purple-800",children:ie(s.orphanBirthDate)}):"-"}),e.jsx("td",{className:"px-3 py-2",children:s.orphanBirthDate||"غير محدد"}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs(I,{className:"bg-muted text-foreground",children:[s.martyrdomType==="war_2023"&&"شهيد حرب ٢٠٢٣",s.martyrdomType==="pre_2023_war"&&"شهيد حرب ما قبل ذلك",s.martyrdomType==="natural_death"&&"وفاة طبيعية",!s.martyrdomType&&"غير محدد"]})}),e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:s.guardianName}),e.jsx("td",{className:"px-3 py-2 font-medium",children:s.orphanName}),e.jsx("td",{className:"px-3 py-2 font-medium text-muted-foreground",children:s.orphanID||"غير محدد"})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-muted-foreground py-4",children:"لا يوجد أيتام مسجلين لهذه الأسرة."})})})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:c.orphans&&c.orphans.length>0?c.orphans.map(s=>e.jsx("div",{className:"bg-muted/30 rounded-lg p-4 space-y-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:s.orphanID||"غير محدد"}),e.jsx("h4",{className:"font-medium text-sm",children:s.orphanName})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(I,{className:s.gender==="male"?"bg-blue-100 text-blue-800 text-xs":"bg-pink-100 text-pink-800 text-xs",children:ne(s.gender)||"غير محدد"}),s.orphanBirthDate&&e.jsx(I,{className:"bg-purple-100 text-purple-800 text-xs",children:ie(s.orphanBirthDate)}),e.jsxs(I,{className:"bg-muted text-foreground text-xs",children:[s.martyrdomType==="war_2023"&&"شهيد حرب ٢٠٢٣",s.martyrdomType==="pre_2023_war"&&"شهيد حرب ما قبل ذلك",s.martyrdomType==="natural_death"&&"وفاة طبيعية",!s.martyrdomType&&"غير محدد"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["رقم الهوية: ",s.orphanID||"غير محدد"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["تاريخ الميلاد: ",s.orphanBirthDate||"غير محدد"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["اسم الوصي: ",s.guardianName]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{size:"sm",variant:"outline",onClick:()=>{$(s),S(!0)},className:"p-2",children:e.jsx(me,{className:"h-3 w-3"})}),e.jsx(N,{size:"sm",variant:"destructive",onClick:()=>be.mutate(s.id),className:"p-2",children:e.jsx(de,{className:"h-3 w-3"})})]})]})},s.id)):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"لا يوجد أيتام مسجلين لهذه الأسرة."})}),xe&&e.jsx(Ge,{initialData:h,onSubmit:h?s=>ge.mutate({orphanId:h.id,data:s}):s=>le.mutate(s),isLoading:le.isPending||ge.isPending,isEdit:!!h,onCancel:()=>{S(!1),$(null)}})]})]})})]})]})}):e.jsx(pe,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg text-muted-foreground",children:"لا توجد بيانات متاحة لهذه الأسرة."})})})}function qe({initialData:i,onSubmit:g,onCancel:Z,isLoading:p,isEdit:_,customRelationship:L,setCustomRelationship:r,showCustomRelationship:F,setShowCustomRelationship:j,showDisabilityType:b,setShowDisabilityType:M,customDisabilityType:k,setCustomDisabilityType:D,showChronicIllnessType:Q,setShowChronicIllnessType:re,customChronicIllnessType:P,setCustomChronicIllnessType:z}){const[n,q]=u.useState({fullName:(i==null?void 0:i.fullName)||"",memberID:(i==null?void 0:i.memberID)||"",birthDate:(i==null?void 0:i.birthDate)||"",gender:(i==null?void 0:i.gender)||"male",relationship:ce.some(x=>x.value===(i==null?void 0:i.relationship))?i==null?void 0:i.relationship:i!=null&&i.relationship?"other":"son",isDisabled:(i==null?void 0:i.isDisabled)||!1,disabilityType:(i==null?void 0:i.disabilityType)||"",hasChronicIllness:(i==null?void 0:i.hasChronicIllness)||!1,chronicIllnessType:(i==null?void 0:i.chronicIllnessType)||"",hasWarInjury:(i==null?void 0:i.hasWarInjury)||!1,warInjuryType:(i==null?void 0:i.warInjuryType)||""}),[f,ee]=u.useState({fullName:"",memberID:"",birthDate:"",gender:"",relationship:""}),[U,c]=u.useState(n.hasWarInjury),[ae,T]=u.useState(n.warInjuryType||"");u.useEffect(()=>{j(n.relationship==="other")},[n.relationship,j]),u.useEffect(()=>{M(n.isDisabled)},[n.isDisabled,M]),u.useEffect(()=>{re(n.hasChronicIllness),n.hasChronicIllness&&n.chronicIllnessType&&z(n.chronicIllnessType)},[n.hasChronicIllness,n.chronicIllnessType,re]),u.useEffect(()=>{c(n.hasWarInjury),n.hasWarInjury&&n.warInjuryType&&T(n.warInjuryType)},[n.hasWarInjury,n.warInjuryType,c]);const se=()=>{const x={fullName:!n.fullName||n.fullName.trim()===""?"الاسم مطلوب":"",memberID:n.memberID&&n.memberID.length>0&&n.memberID.length!==9?"رقم الهوية يجب أن يكون 9 أرقام":"",birthDate:n.birthDate?"":"تاريخ الميلاد مطلوب",gender:n.gender?"":"الجنس مطلوب",relationship:n.relationship?"":"القرابة مطلوبة"};return ee(x),!Object.values(x).some(h=>h!=="")};function X(x){const{name:h,value:$,type:xe,checked:S}=x.target;q(le=>({...le,[h]:xe==="checkbox"?S:$})),h==="relationship"&&$==="other"&&r(""),h==="isDisabled"&&!S&&D(""),h==="hasChronicIllness"&&!S&&z(""),h==="hasWarInjury"&&!S&&T("")}function te(x){x.preventDefault(),se()&&g({...n,relationship:n.relationship==="other"?L:n.relationship,disabilityType:b?k:"",chronicIllnessType:Q?P:"",warInjuryType:U?ae:""})}return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",dir:"rtl",children:e.jsxs("form",{onSubmit:te,className:"space-y-4 md:space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:_?"تعديل بيانات الفرد":"إضافة فرد جديد"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"fullName",className:"text-sm sm:text-base font-medium",children:"الاسم الكامل *"}),e.jsx(l,{id:"fullName",name:"fullName",value:n.fullName,onChange:X,className:`text-right mt-1 ${f.fullName?"border-destructive focus:ring-destructive":""}`}),f.fullName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:f.fullName})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"memberID",className:"text-sm sm:text-base font-medium",children:"رقم الهوية"}),e.jsx(l,{id:"memberID",name:"memberID",value:n.memberID,onChange:X,className:`text-right mt-1 ${f.memberID?"border-destructive focus:ring-destructive":""}`}),f.memberID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:f.memberID})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"birthDate",className:"text-sm sm:text-base font-medium",children:"تاريخ الميلاد *"}),e.jsx(l,{id:"birthDate",name:"birthDate",type:"date",value:n.birthDate,onChange:X,className:`text-right mt-1 ${f.birthDate?"border-destructive focus:ring-destructive":""}`}),f.birthDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:f.birthDate})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"gender",className:"text-sm sm:text-base font-medium",children:"الجنس *"}),e.jsxs(G,{value:n.gender,onValueChange:x=>{q(h=>({...h,gender:x})),f.gender&&ee(h=>({...h,gender:""}))},dir:"rtl",children:[e.jsx(O,{className:`text-right ${f.gender?"border-destructive focus:ring-destructive":""}`,children:e.jsx(V,{placeholder:"اختر الجنس",className:"text-right"})}),e.jsxs(R,{dir:"rtl",children:[e.jsx(C,{value:"male",className:"text-right",children:"ذكر"}),e.jsx(C,{value:"female",className:"text-right",children:"أنثى"})]})]}),f.gender&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:f.gender})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"relationship",className:"text-sm sm:text-base font-medium",children:"القرابة *"}),e.jsxs(G,{value:n.relationship,onValueChange:x=>{q(h=>({...h,relationship:x})),f.relationship&&ee(h=>({...h,relationship:""}))},dir:"rtl",children:[e.jsx(O,{className:`text-right ${f.relationship?"border-destructive focus:ring-destructive":""}`,children:e.jsx(V,{placeholder:"اختر القرابة",className:"text-right"})}),e.jsx(R,{dir:"rtl",children:ce.map(x=>e.jsx(C,{value:x.value,className:"text-right",children:x.label},x.value))})]}),F&&e.jsx(l,{className:"mt-2 text-right",placeholder:"أدخل القرابة",value:L,onChange:x=>r(x.target.value)}),f.relationship&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:f.relationship})]}),e.jsxs("div",{className:"flex flex-col md:flex-row-reverse gap-4",children:[e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"isDisabled",name:"isDisabled",checked:n.isDisabled,onCheckedChange:x=>q(h=>({...h,isDisabled:x}))}),e.jsx(a,{htmlFor:"isDisabled",className:"cursor-pointer",children:"يعاني من إعاقة"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasChronicIllness",name:"hasChronicIllness",checked:n.hasChronicIllness,onCheckedChange:x=>q(h=>({...h,hasChronicIllness:x}))}),e.jsx(a,{htmlFor:"hasChronicIllness",className:"cursor-pointer",children:"يعاني من مرض مزمن"})]})}),e.jsx("div",{className:"rounded-md border border-input p-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2 space-x-reverse",children:[e.jsx(w,{id:"hasWarInjury",name:"hasWarInjury",checked:n.hasWarInjury,onCheckedChange:x=>q(h=>({...h,hasWarInjury:x}))}),e.jsx(a,{htmlFor:"hasWarInjury",className:"cursor-pointer",children:"يعاني من إصابة حرب"})]})})]}),b&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"disabilityType",className:"text-sm sm:text-base font-medium",children:"نوع الإعاقة"}),e.jsx(l,{id:"disabilityType",name:"disabilityType",value:k,onChange:x=>D(x.target.value),className:"text-right mt-1"})]}),Q&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"chronicIllnessType",className:"text-sm sm:text-base font-medium",children:"نوع المرض المزمن"}),e.jsx(l,{id:"chronicIllnessType",name:"chronicIllnessType",value:P,onChange:x=>z(x.target.value),className:"text-right mt-1"})]}),U&&e.jsxs("div",{children:[e.jsx(a,{htmlFor:"warInjuryType",className:"text-sm sm:text-base font-medium",children:"نوع إصابة الحرب"}),e.jsx(l,{id:"warInjuryType",name:"warInjuryType",value:ae,onChange:x=>T(x.target.value),className:"text-right mt-1"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 pt-4",children:[e.jsx(N,{type:"button",variant:"outline",onClick:Z,className:"w-full sm:w-auto",children:"إلغاء"}),e.jsx(N,{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto",disabled:p,children:p?"جاري الحفظ...":_?"تحديث":"إضافة"})]})]})})})}function Ge({initialData:i,onSubmit:g,onCancel:Z,isLoading:p,isEdit:_}){const L=We({orphanName:v().min(1,"اسم اليتيم مطلوب"),orphanBirthDate:v().min(1,"تاريخ ميلاد اليتيم مطلوب"),orphanID:v().regex(/^\d{9}$/,"رقم هوية اليتيم يجب أن يكون 9 أرقام").optional(),gender:ye(["male","female"],{errorMap:(j,b)=>j.code==="invalid_enum_value"?{message:"الجنس مطلوب"}:{message:b.defaultError}}),guardianName:v().min(1,"اسم الوصي مطلوب"),guardianID:v().regex(/^\d{9}$/,"رقم هوية الوصي يجب أن يكون 9 أرقام"),guardianBirthDate:v().min(1,"تاريخ ميلاد الوصي مطلوب"),fatherName:v().min(1,"اسم الاب مطلوب"),fatherID:v().regex(/^\d{9}$/,"رقم هوية الاب يجب أن يكون 9 أرقام"),martyrdomDate:v().min(1,"تاريخ الاستشهاد مطلوب"),martyrdomType:ye(["war_2023","pre_2023_war","natural_death"],{errorMap:(j,b)=>j.code==="invalid_enum_value"?{message:"حالة الوفاة مطلوبة"}:{message:b.defaultError}}),bankAccountNumber:v().min(1,"رقم حساب البنك مطلوب"),accountHolderName:v().min(1,"اسم صاحب الحساب مطلوب"),currentAddress:v().min(1,"العنوان الحالي مطلوب"),originalAddress:v().min(1,"العنوان الاصلي مطلوب"),mobileNumber:v().regex(/^\d{10}$/,"رقم الجوال يجب أن يكون 10 أرقام"),backupMobileNumber:v().regex(/^\d{10}$/,"رقم الجوال الاحتياطي يجب أن يكون 10 أرقام").optional(),image:v().optional()}),r=Ae({resolver:Be(L),defaultValues:{orphanName:"",orphanBirthDate:"",orphanID:"",gender:"",guardianName:"",guardianID:"",guardianBirthDate:"",fatherName:"",fatherID:"",martyrdomDate:"",martyrdomType:"",bankAccountNumber:"",accountHolderName:"",currentAddress:"",originalAddress:"",mobileNumber:"",backupMobileNumber:"",image:"",...i}}),F=j=>{g(j)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4 md:p-6 w-full max-w-xl max-h-[90vh] overflow-y-auto",dir:"rtl",children:e.jsxs("form",{onSubmit:r.handleSubmit(F),className:"space-y-4 md:space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:_?"تعديل بيانات اليتيم":"إضافة يتيم جديد"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"orphanName",className:"text-sm sm:text-base font-medium",children:"اسم اليتيم *"}),e.jsx(l,{id:"orphanName",placeholder:"اسم اليتيم",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.orphanName?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("orphanName")}),r.formState.errors.orphanName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.orphanName.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"orphanID",className:"text-sm sm:text-base font-medium",children:"رقم هوية اليتيم"}),e.jsx(l,{id:"orphanID",placeholder:"رقم هوية اليتيم",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.orphanID?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("orphanID")}),r.formState.errors.orphanID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.orphanID.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"orphanBirthDate",className:"text-sm sm:text-base font-medium",children:"تاريخ ميلاد اليتيم *"}),e.jsx(l,{id:"orphanBirthDate",type:"date",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.orphanBirthDate?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("orphanBirthDate")}),r.formState.errors.orphanBirthDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.orphanBirthDate.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"gender",className:"text-sm sm:text-base font-medium",children:"الجنس"}),e.jsxs(G,{value:["male","female"].includes(r.watch("gender")||"")?r.watch("gender"):"",onValueChange:j=>r.setValue("gender",j),dir:"rtl",children:[e.jsx(O,{className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${r.formState.errors.gender?"border-destructive focus:ring-destructive":""}`,children:e.jsx(V,{placeholder:"اختر الجنس"})}),e.jsxs(R,{dir:"rtl",children:[e.jsx(C,{value:"male",className:"text-sm sm:text-base",children:"ذكر"}),e.jsx(C,{value:"female",className:"text-sm sm:text-base",children:"أنثى"})]})]}),r.formState.errors.gender&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.gender.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"guardianName",className:"text-sm sm:text-base font-medium",children:"اسم الوصي *"}),e.jsx(l,{id:"guardianName",placeholder:"اسم الوصي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.guardianName?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("guardianName")}),r.formState.errors.guardianName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.guardianName.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"guardianID",className:"text-sm sm:text-base font-medium",children:"رقم هوية الوصي *"}),e.jsx(l,{id:"guardianID",placeholder:"رقم هوية الوصي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.guardianID?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("guardianID")}),r.formState.errors.guardianID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.guardianID.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"guardianBirthDate",className:"text-sm sm:text-base font-medium",children:"تاريخ ميلاد الوصي *"}),e.jsx(l,{id:"guardianBirthDate",type:"date",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.guardianBirthDate?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("guardianBirthDate")}),r.formState.errors.guardianBirthDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.guardianBirthDate.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"fatherName",className:"text-sm sm:text-base font-medium",children:"اسم الاب *"}),e.jsx(l,{id:"fatherName",placeholder:"اسم الاب",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.fatherName?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("fatherName")}),r.formState.errors.fatherName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.fatherName.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"fatherID",className:"text-sm sm:text-base font-medium",children:"رقم هوية الاب *"}),e.jsx(l,{id:"fatherID",placeholder:"رقم هوية الاب",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.fatherID?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("fatherID")}),r.formState.errors.fatherID&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.fatherID.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"martyrdomDate",className:"text-sm sm:text-base font-medium",children:"تاريخ الاستشهاد *"}),e.jsx(l,{id:"martyrdomDate",type:"date",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.martyrdomDate?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("martyrdomDate")}),r.formState.errors.martyrdomDate&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.martyrdomDate.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"martyrdomType",className:"text-sm sm:text-base font-medium",children:"حالة الوفاة *"}),e.jsxs(G,{value:["war_2023","pre_2023_war","natural_death"].includes(r.watch("martyrdomType")||"")?r.watch("martyrdomType"):"",onValueChange:j=>r.setValue("martyrdomType",j),dir:"rtl",children:[e.jsx(O,{className:`h-10 sm:h-11 text-sm sm:text-base mt-1 ${r.formState.errors.martyrdomType?"border-destructive focus:ring-destructive":""}`,children:e.jsx(V,{placeholder:"اختر حالة الوفاة"})}),e.jsxs(R,{dir:"rtl",children:[e.jsx(C,{value:"war_2023",className:"text-sm sm:text-base",children:"شهيد حرب ٢٠٢٣"}),e.jsx(C,{value:"pre_2023_war",className:"text-sm sm:text-base",children:"شهيد حرب ما قبل ذلك"}),e.jsx(C,{value:"natural_death",className:"text-sm sm:text-base",children:"وفاة طبيعية"})]})]}),r.formState.errors.martyrdomType&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.martyrdomType.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"bankAccountNumber",className:"text-sm sm:text-base font-medium",children:"رقم حساب البنك *"}),e.jsx(l,{id:"bankAccountNumber",placeholder:"رقم حساب البنك",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.bankAccountNumber?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("bankAccountNumber")}),r.formState.errors.bankAccountNumber&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.bankAccountNumber.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"accountHolderName",className:"text-sm sm:text-base font-medium",children:"اسم صاحب الحساب *"}),e.jsx(l,{id:"accountHolderName",placeholder:"اسم صاحب الحساب",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.accountHolderName?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("accountHolderName")}),r.formState.errors.accountHolderName&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.accountHolderName.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"mobileNumber",className:"text-sm sm:text-base font-medium",children:"رقم الجوال *"}),e.jsx(l,{id:"mobileNumber",placeholder:"رقم الجوال",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.mobileNumber?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("mobileNumber")}),r.formState.errors.mobileNumber&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.mobileNumber.message})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"backupMobileNumber",className:"text-sm sm:text-base font-medium",children:"رقم جوال احتياطي"}),e.jsx(l,{id:"backupMobileNumber",placeholder:"رقم جوال احتياطي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.backupMobileNumber?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("backupMobileNumber")}),r.formState.errors.backupMobileNumber&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.backupMobileNumber.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{htmlFor:"currentAddress",className:"text-sm sm:text-base font-medium",children:"العنوان الحالي *"}),e.jsx(l,{id:"currentAddress",placeholder:"العنوان الحالي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.currentAddress?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("currentAddress")}),r.formState.errors.currentAddress&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.currentAddress.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{htmlFor:"originalAddress",className:"text-sm sm:text-base font-medium",children:"العنوان الاصلي *"}),e.jsx(l,{id:"originalAddress",placeholder:"العنوان الاصلي",className:`h-10 sm:h-11 text-sm sm:text-base mt-1 text-right ${r.formState.errors.originalAddress?"border-destructive focus:ring-destructive":""}`,dir:"rtl",...r.register("originalAddress")}),r.formState.errors.originalAddress&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.originalAddress.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{htmlFor:"image",className:"text-sm sm:text-base font-medium",children:"رفع صورة اليتيم"}),e.jsxs("div",{className:"mt-1",children:[e.jsx(l,{id:"image",type:"file",accept:"image/*",className:"hidden",dir:"rtl",onChange:j=>{var M;const b=(M=j.target.files)==null?void 0:M[0];b&&$e(b).then(k=>{const D=new FileReader;D.onload=()=>{r.setValue("image",D.result)},D.readAsDataURL(k)}).catch(k=>{console.error("Error compressing image:",k);const D=new FileReader;D.onload=()=>{r.setValue("image",D.result)},D.readAsDataURL(b)})}}),e.jsxs(N,{type:"button",variant:"outline",className:"w-full justify-between",onClick:()=>{var j;return(j=document.getElementById("image"))==null?void 0:j.click()},children:[e.jsx("span",{className:"text-right flex-1",children:r.watch("image")?"تم اختيار ملف":"اختر ملف"}),e.jsx("span",{className:"text-xs text-muted-foreground mr-2",children:"..."})]})]}),(i==null?void 0:i.image)&&e.jsxs("div",{className:"mt-2",children:[e.jsx(a,{className:"text-sm text-muted-foreground",children:"الصورة الحالية:"}),e.jsx("div",{className:"mt-1 flex justify-center items-center",children:e.jsx("img",{src:i.image,alt:"صورة اليتيم",className:"max-h-32 max-w-full object-contain border rounded"})})]}),r.formState.errors.image&&e.jsx("p",{className:"text-xs sm:text-sm text-destructive mt-1",children:r.formState.errors.image.message})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 pt-4",children:[e.jsx(N,{type:"button",variant:"outline",onClick:Z,className:"w-full sm:w-auto",children:"إلغاء"}),e.jsx(N,{type:"submit",disabled:p,className:"bg-purple-600 hover:bg-purple-700 text-white w-full sm:w-auto",children:p?"جاري الحفظ...":_?"تحديث":"إضافة"})]})]})})})}export{es as default};
